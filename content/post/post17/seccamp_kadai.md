---
title: "セキュリティキャンプ応募課題晒し (2023, L1 暗号化通信ゼミ)"
date: 2023-08-12T20:40:36+09:00
math: true
draft: true
---

$\gdef\Z{\mathbb{Z}}$

## はじめに

　どうも，mitsu です．今までなんやかんや忙しくて参加できないでいたセキュリティキャンプに，ついに今年は幸運にも参加することができました．

　興味のあるゼミはいくつかありましたが，とんでもなく強い講師の方々がいらっしゃるのでせっかくだからと自分の一番興味のある部分をさらに伸ばそうと思い L1（暗号化通信ゼミ）のプリミティブコースに応募しました．

　より具体的に言うと，Castryck と Decru によって 2022 年の夏頃に SIDH（更に正確には SIKE）を破る論文が出されちょうどそれを読んでいたのですがあまりにも難しくて，それの実装を達成するために講師の方の力を借りようと思いました．というのもこのアルゴリズムは公開実装例が２つしか見当たらなかったくらいには難解で，ちょっと僕だけではしっかり論文を読めないなと思ったからです．

　プリミティブコースという言葉をパッと出してしまいましたが，今年の L1 コースはプロコトルコースとプリミティブコースの二種類が選択できました．プロトコルコースは暗号化通信ゼミの名前の通り暗号化通信をメインでやる部分です．一方でプリミティブコースは暗号そのものをメインでやる部分です．講師の方々は「コースにとらわれないで流動的であってほしい」と言っていましたが，僕が一にも二にも暗号プリミティブだったこともあって相互で干渉し合うことはあまりできませんでした．ちょこちょこプロトコルコースのボイスチャットにはお邪魔してみてたんですが「プロトコルを実装するってどういうことですか」を質問するレベルでネットワークの知識がなく，まあなんというか多分僕のせいです，すみません．

　それはともかくとして，実は今年は年齢的に最初で最後のチャンスだったのもありなんとしてでも全国大会に通る必要があります．とはいってもセキュリティキャンプに応募してくるような人は強い人が多く，ただ僕が適当に応募課題を書いても通るわけがありません．そこで L1 の応募課題を読んでみると「丁寧であればあるほどよく，さらに分量の制限はない」という旨の記述があったので，僕はとにかく書けることはたくさん書いて絶対に受かると自信をもって言える（逆に言えばこれで受からなかったら自分で納得できる）くらいに内容を仕上げてみました．  
　それが功を奏したのが無事選考を通過でき，また講師の先生方にはサーベイ論文と揶揄されて結果的に戦略は成功だったのかなと思います．

　ということで，来年以降の L1 ゼミに応募したい方の参考になればいいなという意味も含め応募課題晒しの文化に則って僕も応募課題をインターネットの海に放り込んでみます．（ちなみに参加期も後で書こうと思っています．技術的な内容は少なめだとは思いますがぜひ読んでみてください！）

## Q1.

以降の設問文は全て応募課題からの引用です．(プロトコールコースや他ゼミの応募課題も含めた応募課題関連の情報は [ここ](https://www.ipa.go.jp/jinzai/security-camp/2023/zenkoku/vote.html) に色々書いてあります)

> **以下の語句から一つ選び, その語句に関してできるだけ詳しく説明してください.**
> - AES-128-GCM
> - McEliece暗号
> - Grøstl
> - SIDH

---

### SIDH 

#### 概要
SIDH は一言で説明すると，楕円曲線の同種写像を利用した耐量子暗号アルゴリズムです．

RSA や DLP といった既存の暗号の基礎問題は比較的簡単に解ける量子アルゴリズムが見つかっており，このまま量子コンピュータの研究が進むと既存の暗号システムが脆弱なものとなってしまいます．そのため耐量子暗号の研究が盛んにおこなわれており，格子ベースのものや符号ベースのものが開発されています．SIDH はそのポスト量子暗号の中で楕円曲線の同種写像グラフを利用したもので，データサイズが小さいことを期待されて研究，開発が進められています．

#### 同種写像問題
SIDH の base problem は，次の同種写像問題に関する仮定となっています [1] ．

**base problem**
楕円曲線 $E$ と同種写像 $\phi$ による同種な曲線 $E' = \phi(E)$ が与えられたとき，その間にある $\phi$ を求めることは困難である．

#### SIDH の鍵交換アルゴリズム
同種写像問題を利用した鍵交換をする基本的な手続きは，次の同種関係による可換図式に基づいています．

$$\begin{CD} E @\>\phi_B\>\> E_B\\\\ 
@V\phi_A V V @V V\phi_A' V\\\\ 
E_A @\>\phi_B' \>\> E_{AB} \end{CD}$$

実際の鍵交換アルゴリズムは次に従います [2]．

##### public parameter
- $p = l_A^{e_A}l_B^{e_B} - 1$
- super singular elliptic curve $E_0(\mathbb{F_{p^2}})$
- 生成元 $P_A, Q_A \in E\lbrack l_A^{e_A}\rbrack$
- 生成元 $P_B, Q_B \in E\lbrack l_B^{e_B}\rbrack$

##### Alice's key
- (private) 乱数 $m_A,n_A \in (\Z/l_A^{e_A}\Z)^\times$
- (private) 同種写像 $\phi_A: E_0 \rightarrow E_A,$　ただし $\ker \phi_A = \left< [m_A]P_A + [n_A]Q_A \right>$
- (public) $\phi_A(P_B),\ \phi_A(Q_B)$
- (public) $E_A = \phi_A(E_0)$

##### Bob's key
- (private) 乱数 $m_B, n_B \in (\Z/l_B^{e_B}\Z)^\times$
- (private) 同種写像 $\phi_B: E_0 \rightarrow E_B,$　ただし $\ker \phi_B = \left< [m_B]P_B + [n_B]Q_B \right>$
- (public) $\phi_B(P_A),\ \phi_B(Q_A)$
- (public) $E_B = \phi_B(E_0)$

##### 鍵交換手順
[Alice]
1. 同種写像 $\phi_A^0: E_B \rightarrow E_{AB}$ を計算．ただし $\ker \phi_A^0 = \left< [m_A]\phi_B(P_A) + [n_A]\phi_B(Q_A) \right>$
2. $E_{AB} = \phi_A^0(E_B) = \phi_A^0(\phi_B(E_0))$ を計算

[Bob]
1. 同種写像 $\phi_B^0: E_A \rightarrow E_{AB}$ を計算．ただし $\ker \phi_B^0 = \left< [m_B]\phi_A(P_B) + [n_B]\phi_A(Q_B) \right>$
2. $E_{AB} = \phi_B^0(E_A) = \phi_B^0(\phi_A(E_0))$ を計算

[shared key]
- j不変量 $j(E_{AB})$

### 参考文献
[1] [相川勇輔，"同種写像暗号１：楕円曲線と同種写像グラフ"](https://joint.imi.kyushu-u.ac.jp/wp-content/uploads/2022/08/220802_03aikawa.pdf)  
[2] David Jao，Luca De Feo，"Towards quantum-resistant cryptosystems from supersingular elliptic curve isogenies"
