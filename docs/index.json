[{"content":"はじめまして，mitsuです．はてなブログから移行してきました．やっぱり自由にかけたほうが個人的に楽なのです．\nCTFをやっているので，そのwriteupをぼちぼちあげていこうかなって思ってます．あとは暗号が好きなので，その辺の数論の話なんかも強くなったら書きたいななんて思ってます．\nではこれからどうぞよろしくお願いします．\nところで，こんなことしてないでレポート書いたほうが良くないですか？厳しい……\n","description":"","id":0,"section":"posts","tags":null,"title":"First","uri":"https://mitsu1119.github.io/blog/posts/post1/first/"},{"content":"はじめに 1. 格子 2. 格子の行列式 3. 逐次最小 4. グラム・シュミットの直交化法 5. Lagrangeの方法 6. LLL簡約基底とサイズ簡約 7. Lovászの条件 8. LLL簡約と計算量 9. 最適化  はじめに 大体タイトル通りの記事です．LLLを解説していきます．\n性質や定理の証明は一つ一つ丁寧に与えていこうと思いますが，何から何まで全てやって記事を書ききる自信はないので，基本的な線形代数の内容(特に線形空間やノルム周り)は前提知識として進めていきます．また，格子に関する基本的な性質やLLLを理解するのに必要な部分の解説しかないので，もしこの記事を読んでもっと勉強したいと思った方は適当な本を読むことをお勧めします（つまり内容が薄いです．許してください）．\nもし自分が理解したつもりになっている内容に誤りがあったらコメントで教えてください．特に用語の日本語訳が非常に怪しい感じになっています．証明の書き方が稚拙だったり，特にサイズ簡約の部分で添え字が複雑になってしまっていたり，正直そこまでうまく説明できている自信がないためお手柔らかにお願いします……あと，判断できない命題はとりあえず定理にしています．お許しください．\nとにかくコードだけ欲しいという方はこのリポジトリを参照してください．verifyはしてないので結構怪しい感じですが，オープンソースで上がっている他のLLLと比較したら出力が同じだったので多分大丈夫だと思います．\n   1. 格子 一応この記事は，格子を知らない状態からLLLを理解するまでの道みたいな感じで作ったつもりです．ということで，前提となる格子からをちゃんと定義しておきます．\n定義 1.1:\n線形独立な $n$ 本のベクトル $b_1,b_2,\\cdots ,b_n \\in \\mathbb{R}^m$ によって張られる格子 $ \\mathcal{L}(b_1,b_2,\\cdots,b_n)$ を次のように定義する．$$\\displaystyle \\mathcal{L}(b_1,b_2,\\cdots,b_n) = \\left\\{ \\sum x_ib_i \\mathrel{}\\middle|\\mathrel{} x_i \\in \\mathbb{Z} \\right\\}$$この時， $ \\left\\{b_1,b_2,\\cdots,b_n \\right\\}$ を格子の基底と呼び， $ n$ を格子の次数と言う．\nまた $ n = m$ であるとき，格子 $ \\mathcal{L}(b_1,b_2,\\cdots,b_n)$ はfull-rankであると言う．\nfull-rankでない例は $ m \u0026gt; n$ の場合を適当に考えれば作れます．例えば $ {}^tb_1 = \\begin{pmatrix} 1 \u0026amp; 0 \u0026amp; 1 \\end{pmatrix},\\ {}^tb_2 = \\begin{pmatrix} 0 \u0026amp; 1 \u0026amp; 2 \\end{pmatrix}$ とすれば $ b_1$ と $ b_2$ は線形独立ですが，これによって作られる二次元の格子 $ \\mathcal{L}(b_1,b_2)$ は明らかにfull-rankになりません．また， $ m \u0026lt; n$ の時は各ベクトルが線形独立にならないので注意してください．\n格子の表記について，基底となる列ベクトル $ b_1,b_2,\\cdots,b_n$ を横に並べた $ m \\times n$ 行列 $ B$ を使って$$ \\mathcal{L}(B) = \\mathcal{L}(b_1,b_2,\\cdots,b_n) = \\left\\{ Bx \\mathrel{}\\middle|\\mathrel{} x \\in \\mathbb{Z}^n \\right\\}$$と表すこともあります．このときの $B$ のことを基底行列と言います．\n一応図を用意しました．黒い点が格子の元で，原点から出ている黒い矢印が基底を構成するベクトルです．なんとなく格子という名前通りの集合になっていますね．\n$$ \\displaystyle B=\\begin{pmatrix} 1 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\end{pmatrix}$$\n$$ \\displaystyle B=\\begin{pmatrix} 1 \u0026amp; 1 \u0026amp; 1 \u0026amp; 2 \\end{pmatrix}$$\nこの例を見て気づいた方は多いと思いますが，実は倍数全体の集合 $ m\\mathbb{Z}^n$ も格子です．基底行列を $ mI$ と取ればうまく張れると思います．\nちなみに上の例の二つの基底行列は同じ格子を張ります．このような，同じ格子を張るような基底は無限に存在します．\n定義 1.2:\n整数行列かつ行列式が $1$ か $-1$ であるような正方行列をユニモジュラ行列という．\nユニモジュラ行列 $ U$ の行基本変形を考えれば， $ U^{-1}$ もまたユニモジュラ行列であることがわかります．また，二つのユニモジュラ行列 $ U,U'$ について， $ \\det(UU') = \\det U \\cdot \\det U' = \\pm1$ となります．よって $ n$ 次のユニモジュラ行列全体は $ n$ 次の正則行列からなる群の部分群となります．ちなみにこの群は， $ GL_n(\\mathbb{Z})$ と表せます．\n実は，このユニモジュラ行列を使えば基底行列$ B_1, B_2$が同じ格子を張るか否かを考えることができます．\n定理 1.1:\n基底行列 $ B_1, B_2 \\in \\mathbb{R}^{m \\times n}$ が同じ格子を張る，つまり $ \\mathcal{L}(B_1)= \\mathcal{L}(B_2)$ である必要十分条件は， $ B_1 = B_2U$ となるユニモジュラ行列 $ U$ が存在することである．\n証明:\nまず $ \\mathcal{L}(B_1) = \\mathcal{L}(B_2)$ と仮定する．このとき格子の定義より， $ B_1 = B_2V,\\ B_2 = B_1W$ を満たす整数の正方行列 $V,W$ が存在する．従って $ B_1 = B_1WV$ なので $ B_1(I - WV)= O$ となる（ただし $ I$ は $ n$ 次の単位行列）． $ B_1$ は線形独立なベクトルの集まりだったため $ WV = I$ となり，行列式を考えると $ \\det(WV) = \\det W \\cdot \\det V = 1$ ． $ \\det W,\\det V \\in \\mathbb{Z}$ なので $ \\det W=\\det V= \\pm 1$ となる．\n次に，あるユニモジュラ行列 $ U$ を使って $ B_1 = B_2U$ と書けたと仮定する．この時，格子の定義より $ \\mathcal{L}(B_1) \\subseteq \\mathcal{L}(B_2)$ である．また $ B_1U^{-1} = B_2$ でもあり， $ U^{-1}$ もユニモジュラ行列なので同様に $ \\mathcal{L}(B_2) \\subseteq \\mathcal{L}(B_1)$ ．従って $ \\mathcal{L}(B_1) = \\mathcal{L}(B_2)$ ． $ ■$\nこのように，同じ格子の基底同士はユニモジュラ行列によって関連付けられています．\n 2. 格子の行列式 定義 2.1:\n基底行列 $ B = \\begin{pmatrix} b _ {1} \u0026amp; \\cdots \u0026amp; b _ {n} \\end{pmatrix} \\in \\mathbb{R}^{m \\times n}$ の格子 $ \\Lambda$ のスパン $ \\mathrm{span}(\\Lambda)$ とは，次のような線形包である．$$ \\mathrm{span}(\\Lambda) = \\mathrm{span}(b_1,\\cdots,b_n) = \\mathrm{span}(B) = \\left\\{ By \\mathrel{}\\middle|\\mathrel{} y \\in \\mathbb{R}^n \\right\\}$$\n定義より，格子 $ \\Lambda$ の基底行列 $ B$ は $ \\mathrm{span}(\\Lambda)$ の基底行列にもなります．また，格子 $ \\Lambda$ がfull-rankな時， $ \\mathrm{span}(\\Lambda) = \\mathbb{R}^n$ となります．このスパンのおかげで格子の点と点の隙間を考えることができ，格子上の計算をスパンにマッピングして行ってから元の格子に射影し直すという操作を使うことで，それなりに自由に計算が行えるようになります．後述のLLLアルゴリズムもこの方法を使っています．\n定義 2.2:\n格子の基底行列 $ B = \\begin{pmatrix} b _ {1} \u0026amp; b _ {2} \u0026amp; \\cdots \u0026amp; b _ {n} \\end{pmatrix} \\in \\mathbb{R}^{m \\times n}$ の基本平行体 $ \\mathcal{P}(B)$ を次のように定義する．$$ \\displaystyle \\mathcal{P}(B) = \\left\\{ \\sum^{n}_{i=1}x_ib_i \\mathrel{}\\middle|\\mathrel{} 0 \\leq x_i \u0026lt; 1 \\right\\}$$\n基本平行体は，上の格子の例における灰色に塗りつぶしてある部分と対応しています．また，格子の定義より，各格子ベクトルを基準として基本平行体を平行移動させていくことで $ \\mathrm{span}(B)$ をタイリングすることができます．つまり，次の式が成り立ちます．$$ \\displaystyle \\bigcup _ {v\\in \\mathcal{L}( B)}( v+\\mathcal{P}( B)) = \\mathrm{span}(B)$$また，基本平行体に限らずこのような性質を持つ集合を基本領域と呼びます．例えば集合$$ \\displaystyle \\mathcal{C}(B) = \\left\\{ Bx \\mathrel{}\\middle|\\mathrel{} -\\frac{1}{2} \\leq x \u0026lt; \\frac{1}{2} \\right\\}$$も基本領域です（基本平行体とほとんど変わらないけど）．\n定義 2.3:\n基底行列 $ B \\in \\mathbb{R}^{m \\times n}$ の格子 $ \\Lambda$ の行列式を次の式で定義する．$$ \\det \\Lambda = \\mathrm{vol}(\\mathcal{P}(B)) = \\sqrt{\\det\\left({}^t!BB\\right)}$$但し $ \\mathrm{vol}(\\mathcal{P}(B))$ は基本平行体 $ \\mathcal{P}(B)$ の $ n$ 次元体積とする．\n$ B$ が正方行列，つまりfull-rankな格子の基底行列であれば $ \\det B = \\det({}^tB)$ なので， $ \\det \\Lambda$ はより簡単に $ \\det \\Lambda = |\\det B|$ と表せます．\nまた，格子の行列式は基底の取り方によらず一定です．つまり，ある格子の基底行列 $ B_1,B_2$ について $ \\Lambda = \\mathcal{L}(B_1) = \\mathcal{L}(B_2)$ ならば， $$ \\det \\Lambda = \\det(\\mathcal{L}(B_1)) = \\det(\\mathcal{L}(B_2))$$ が成り立ちます．なぜなら， $ \\mathcal{L}(B_1) = \\mathcal{L}(B_2)$ なのであるユニモジュラ行列 $ U$ を用いて $ B_1 = B_2U$ とかけ，この時 $$ \\det(\\mathcal{L}(B_1)) = \\sqrt{\\det\\left({}^tB_1B_1\\right)} = \\sqrt{\\det\\left({}^tU{}^tB_2B_2U\\right)} = \\sqrt{\\det\\left({}^tB_2B_2\\right)}$$ が成り立つからです．よって次の定理が得られます．\n定理 2.1\n格子 $ \\Lambda$ の基底行列 $ B_1,B_2$ について，次の式が成り立つ．$$ \\det \\Lambda = \\det(\\mathcal{L}(B_1)) = \\det(\\mathcal{L}(B_2))$$\n逆は言えないので注意してください（基底行列の次数が違う場合が反例としてあげられます）．\n 3. 逐次最小 定義 3.1:\n$ B \\in \\mathbb{R}^{m \\times n}$ を基底行列とする格子 $ \\Lambda$ について，自然数 $ 1 \\leq i \\leq n$ に対する $ i$ 番目の逐次最小 $ \\lambda_i = \\lambda_i(\\Lambda)$ を次の式で定義する．$$\\lambda _ {i} (\\Lambda )=\\inf\\left\\{r \\mathrel{}\\middle|\\mathrel{} i\\leq \\dim (\\mathrm{span} (\\Lambda \\cap B(0;r)))\\right\\} \\ \\\\ \\hspace{6em} \\mathit{where} \\ B(0;r)=\\left\\{x\\in \\mathbb{R}^{m} \\mathrel{}\\middle|\\mathrel{} |x| \\leq r \\right\\} $$\n多分ぱっと見ではこの式が何を言っているのかわかりにくいと思いますが（自分はわからなかった）言っていることは実は結構簡単で，要するに逐次最小 $ \\lambda_i$ とは， $ i$ 個の線形独立な格子の元を含む原点中心の最小の超球の半径です．\nこの定義より，格子 $ \\Lambda$ の線形独立な格子ベクトルを短い順に $ n$ 個とってできたベクトルの組 $ v_1,\\cdots,v_n$ の長さはそれぞれ $ \\lambda_1,\\cdots,\\lambda_n$ となることがわかります．ただし注意として，五次元以上の格子では $ \\left\\{ v_1,\\cdots,v_n \\right\\}$ が必ずしも $ \\Lambda$ の基底になるとは限りません．\n例えば格子 $ \\Lambda$ の基底行列 $ B$ を$$\\displaystyle B=\\begin{pmatrix} b _ {1} \u0026amp; \\cdots \u0026amp; b _ {5} \\end{pmatrix} = \\begin{pmatrix} 2 \u0026amp; \u0026amp; \u0026amp; \u0026amp; 1\\\\ \u0026amp; 2 \u0026amp; \u0026amp; \u0026amp; 1\\\\ \u0026amp; \u0026amp; 2 \u0026amp; \u0026amp; 1\\\\ \u0026amp; \u0026amp; \u0026amp; 2.2 \u0026amp; 1.1\\\\ \u0026amp; \u0026amp; \u0026amp; \u0026amp; 1 \\end{pmatrix}$$としたとき，ノルムが逐次最小になる線形独立な格子ベクトルの組を並べた行列 $ V$ は次のようになります．$$ \\displaystyle V=\\begin{pmatrix} v_{1} \u0026amp; \\cdots \u0026amp; v_{5} \\end{pmatrix} =\\begin{pmatrix} 2 \u0026amp; \u0026amp; \u0026amp; \u0026amp; \\\\ \u0026amp; 2 \u0026amp; \u0026amp; \u0026amp; \\\\ \u0026amp; \u0026amp; 2 \u0026amp; \u0026amp; \\\\ \u0026amp; \u0026amp; \u0026amp; 2.2 \u0026amp; \\\\ \u0026amp; \u0026amp; \u0026amp; \u0026amp; 2 \\end{pmatrix}$$ $ v_5$ は $ 2b_5 - b_4 - b_3 - b_2 - b_1$ で作れます．しかし，格子は基底ベクトルの整数倍しか含まないため， $ b_5 \\notin \\mathcal{L}(V)$ となるため $ V$ は $ \\Lambda$ の基底になれません（基底は実数のベクトルが許されているものの格子点はその整数倍しか許されていないところがミソです）．これと同じような基底行列を用意してあげれば，より高い次元の格子での反例も簡単に作れます．\nでは次に，格子における有名な諸定理を紹介します．\n定理 3.1 (Blichfeldtの定理):\n基底行列 $ B \\in \\mathbb{R}^{m \\times n}$ の格子を $ \\Lambda$ とする．このとき集合 $ S \\subseteq \\mathrm{span}(B)$ について $ \\mathrm{vol}(S) \u0026gt; \\det \\Lambda$ ならば $ z_1 - z_2 \\in \\Lambda$ なる $ z_1,z_2 \\in S$ が存在する．\n証明:\n$ S_x = S \\cap (x + \\mathcal{P}(B)),\\ x \\in \\Lambda$ とすると次の式が成り立つ．$$ \\displaystyle S = \\bigcup _ {x \\in \\Lambda} S _ x$$従って，$$ \\displaystyle \\mathrm{vol}(S)=\\sum _ {x \\in \\Lambda} \\mathrm{vol}(S _ x)$$となる．ところで， $ S _ x' = S _ x - x = (S - x) \\cap \\mathcal{P}(B)$ とすると $ \\mathrm{vol}(S _ x)=\\mathrm{vol}(S' _ x)$ なので，仮定より$$ \\displaystyle \\det \\Lambda \u0026lt; \\mathrm{vol}(S) = \\sum _ {x \\in \\Lambda} \\mathrm{vol}(S _ x) = \\sum _ {x \\in \\Lambda} \\mathrm{vol}(S _ x')$$\nまた， $ S _ x' \\subseteq \\mathcal{P}(B)$ なので $ (S _ x) _ {x \\in \\Lambda}$ は素集合系ではないため， $ S _ x' \\cap S _ y' \\neq \\emptyset$ かつ $ x \\neq y$ を満たす $ x, y \\in \\Lambda$ が存在する．\nよって， $ z \\in S _ x' \\cap S _ y' \\neq \\emptyset$ に対し $ z _ 1 = z + x \\in S _ x, \\ z _ 2 = z + y \\in S _ y$ とすれば $ z _ 1 - z _ 2 = x - y \\in \\Lambda$ となり，定理を満たすベクトルを構成することができる．$ ■$\nまあ要するに，格子$ \\mathcal{L}(B)$のスパン上の，体積が$ \\det \\Lambda$を超える集合は，基本平行体で切り分けて一つの領域に集めた時必ず重なる点があるから成り立つということです（下図参照（画像クリックで拡大できます））．      このBlichfeldtの定理を利用すれば，次の定理が簡単に示せます．**定理 3.2 (Minkowskiの凸体定理):**\n$ \\Lambda$を$ n$次のfull-rankな格子とする．このとき原点に対して対称な凸集合$ M \\subset \\mathbb{R}^n$が$ \\mathrm{vol}(M) \u0026gt; 2^n \\det \\Lambda$ならば，$ x \\in M$を満たす$ x \\neq 0 \\in \\Lambda$が存在する．**証明:\n$ M' = \\left{x \\mathrel{}\\middle|\\mathrel{} 2x \\in M \\right}$とする．このとき仮定より$ \\mathrm{vol}(M') = 2^{-n}\\mathrm{vol}(M) \u0026gt; \\det \\Lambda$となり，Blichfeldtの定理より，$ z_1 - z_2 \\in \\Lambda \\setminus \\left{0\\right}$を満たす$ z_1, z_2 \\in M'$が存在する．また，$ z_1,z_2$は$ M'$の定義より$ 2z_1,2z_2 \\in M$を満たすため，仮定より$ -2z_2 \\in M$なので$ x = z_1 - z_2 = \\frac{2z_1 - 2z_2}{2} \\in M$とすれば定理を満たすベクトルを構成することができる．$ ■$定理 3.3:\n$ n$次のfull-rankな格子$ \\Lambda$の逐次最小$ \\lambda_1$について次の式が成り立つ．$ \\displaystyle \\lambda_1 \\leq \\sqrt{n}(\\det \\Lambda)^{\\frac{1}{n}}$証明:**\n閉球$ B(0; r) \\subset \\mathbb{R}^n$について，立方体$ X = \\left[-\\frac{r}{\\sqrt{n}}, \\frac{r}{\\sqrt{n}} \\right]^{n} \\subset \\mathbb{R}^n$は$ X \\subseteq B(0; r)$を満たす．従って，$ \\mathrm{vol}(X) = 2^n(\\frac{r}{\\sqrt{n}})^n \\leq \\mathrm{vol}(B(0;r))$となる．よって$ r = \\sqrt{n}(\\det \\Lambda)^{\\frac{1}{n}}$とすれば$ \\mathrm{vol}(B(0; r)) \\geq 2^n\\det \\Lambda$が成り立ち，Minkowskiの凸体定理より$ B(0; r)$の内側に格子点が存在するため，$ r = \\sqrt{n}(\\det \\Lambda)^{\\frac{1}{n}}$より短い格子ベクトルが存在する．$ ■$\n ### 4. グラム・シュミットの直交化法 **定義 4.1:** 内積空間$ V$の基底$ \\left\\{b_1, b_2,\\cdots,b_n \\right\\}$から，同じ空間を張るような直交基底$ \\left\\{b_1^*,b_2^*,\\cdots,b_n^* \\right\\}$を次の式から求める操作を**グラム・シュミットの直交化法**という．$ \\displaystyle b^{*}_{i} =b_{i} -\\sum ^{i-1}_{j=1} \\mu _{i,j} b^{*}_{j}\\ \\mathit{where}\\ \\mu _{i,j} =\\frac{\\langle b_{i} ,b^{*}_{j} \\rangle }{\\langle b^{*}_{j} ,b^{*}_{j} \\rangle }$正規化しないことに注意してください（グラム・シュミットの正規直交化として書いてあることが多いので）． また簡単のため，グラム・シュミットの直交化における係数$ \\mu_{i,j}\\ (1 \\leq j \u0026lt; i \\leq n)$を**グラムシュミット係数**と呼び，$ \\left\\{ b_1,\\cdots,b_n \\right\\}$をグラム・シュミットの直交化法で直交化したときに得られる新たなベクトル$ b_1^*,\\cdots,b_n^*$を**グラムシュミットベクトル**と呼ぶことにします．さらに，グラム・シュミットの直交化法を，基底行列$ B = \\begin{pmatrix} b_{1} \u0026amp; \\cdots \u0026amp; b_{n} \\end{pmatrix}$から$ B^* = \\begin{pmatrix} b_{1}^* \u0026amp; \\cdots \u0026amp; b_{n}^* \\end{pmatrix}$を得る操作としても用いるようにします． 一応疑似コードも載せておきます．    見てわかる通り，計算量は$ O(n^2m)$です．では次に，グラムシュミットベクトルの基本的な性質を紹介します．**性質 4.1:** 内積空間$ V$の基底を$ \\left\\{b_1,\\cdots,b_n \\right\\}$とする．このとき，グラムシュミットベクトル$ b_1^*,\\cdots,b_n^* $は自然数$ 1 \\leq i \\leq n$に対し次の式を満たす．  $ \\| b_i^* \\| \\leq \\| b_i \\|$ $ \\langle b_i, b_i^* \\rangle = \\langle b_i^*,b_i^* \\rangle$ **証明:** まず一つ目の式について，$ \\displaystyle \\begin{aligned} \\| b^{*}_{i} \\| ^{2} \u0026amp; =\\langle b_{i} -\\sum ^{i-1}_{j=1} \\mu _{i,j} b^{*}_{j} ,b_{i} -\\sum ^{i-1}_{j=1} \\mu _{i,j} b^{*}_{j} \\rangle \\\\ \u0026amp; =\\| b_{i} \\| ^{2} -\\sum ^{i-1}_{j=1} \\mu ^{2}_{i,j} \\| b^{*}_{j} \\| ^{2} \\end{aligned}$なので明らかに$ \\| b_i^* \\| \\leq \\| b_i \\|$が成り立つ． また，二つ目の式も同様に$ \\displaystyle \\begin{aligned} \\langle b_{i} ,b^{*}_{i} \\rangle \u0026amp; =\\langle b_{i} ,b_{i} -\\sum ^{i-1}_{j=1} \\mu _{i,j} b^{*}_{j} \\rangle \\\\ \u0026amp; =\\| b_{i} \\| ^{2} -\\sum ^{i-1}_{j=1} \\mu _{i,j} \\langle b^{*}_{i} +\\sum ^{i-1}_{k=1} \\mu _{i,k} b^{*}_{k} ,b^{*}_{j} \\rangle \\\\ \u0026amp; =\\| b_{i} \\| ^{2} -\\sum ^{i-1}_{j=1} \\mu _{i,j} \\| b^{*}_{j} \\| ^{2} \\end{aligned}$が成り立ち，$ \\langle b_i, b_i^* \\rangle = \\|b_i^*\\|^2 = \\langle b_i^*, b_i^* \\rangle$となる．$ ■$また，格子$ \\Lambda$の基底$ \\left\\{ b_1, \\cdots, b_n \\right\\} \\in \\mathbb{R}^{m \\times n}$のグラムシュミットベクトルは，定義より明らかに$ \\mathrm{span}(b_1,\\cdots,b_n) = \\mathrm{span}(b_{1}^*, \\cdots , b_{n}^*)$となります．**定理 4.2:** 格子$ \\Lambda$の基底を$ \\left\\{ b_1,\\cdots,b_n \\right\\}$とする．この時，格子の行列式$ \\det \\Lambda$をグラムシュミットベクトル$ b_1^*,\\cdots,b_n^*$を用いて次のように表すことができる．$ \\displaystyle \\det \\Lambda = \\prod_{i = 1}^n \\|b_i^* \\|$**証明:** $ B = \\begin{pmatrix} b_{1} \u0026amp; b_{2} \u0026amp; \\cdots \u0026amp; b_{n} \\end{pmatrix}$とする．このとき，$ b_i = b_i^* + \\sum ^{i-1}_{j=1} \\mu _{i,j} b^{*}_{j}$なので次の式が成り立つ．$ \\displaystyle \\begin{eqnarray} B \u0026amp; = \u0026amp; \\begin{pmatrix} b^{*}_{1} \u0026amp; b^{*}_{2} +\\mu _{2,1} b^{*}_{1} \u0026amp; b^{*}_{3} +\\mu _{3,1} b^{*}_{1} +\\mu _{3,2} b^{*}_{2} \u0026amp; \\cdots \u0026amp; b^{*}_{n} +\\sum ^{n-1}_{j=1} \\mu _{i,j} b^{*}_{j} \\end{pmatrix}\\\\ \u0026amp; = \u0026amp; \\begin{pmatrix} b^{*}_{1} \u0026amp; b^{*}_{2} \u0026amp; b^{*}_{3} \u0026amp; \\cdots \u0026amp; b^{*}_{n} \\end{pmatrix}\\begin{pmatrix} 1 \u0026amp; \\mu _{2,1} \u0026amp; \\mu _{3,1} \u0026amp; \\cdots \u0026amp; \\mu _{n,1}\\\\ 0 \u0026amp; 1 \u0026amp; \\mu _{3,2} \u0026amp; \\cdots \u0026amp; \\mu _{n,2}\\\\ 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; \\cdots \u0026amp; \\mu _{n,3}\\\\ \\vdots \u0026amp; \\vdots \u0026amp; \\vdots \u0026amp; \\ddots \u0026amp; \\vdots \\\\ 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; \\cdots \u0026amp; 1 \\end{pmatrix}\\\\ \u0026amp; = \u0026amp; QR \\end{eqnarray}$ 従って，$ \\displaystyle \\begin{eqnarray} \\det \\Lambda \u0026amp; = \u0026amp; \\sqrt{\\det (^t\\!BB)}\\\\ \u0026amp; = \u0026amp; \\sqrt{\\det (^t\\!R^t\\!QQR)}\\\\ \u0026amp; = \u0026amp; \\sqrt{\\det (^t\\!QQ)}\\\\ \u0026amp; = \u0026amp; \\prod_{i = 1}^n \\|b_i^* \\| \\end{eqnarray}$ $ ■$**定義 4.2:** 格子$ \\Lambda$の基底を$ \\left\\{b_1,\\cdots,b_n\\right\\}$とする．この時次の式で定義される量$ \\delta$を**直交欠陥**と言う．$ \\displaystyle \\delta = \\frac{\\prod ^{n}_{i=1} \\| b_{i} \\| }{\\det \\Lambda }$$ \\det \\Lambda$は，スパンの直交化した基底ベクトルのノルムの総乗でした．そのため直交欠陥は，元の基底がどのくらい直交していないかを表す指標となります．また，元のベクトルが直交していた場合，グラム・シュミットの直交化法を行っても基底は変わらないので直交欠陥は$ 1$になります．**定理 4.3:** 格子$ \\Lambda$の直交欠陥$ \\delta$について次の式が成り立つ．$ \\delta \\geq 1$**証明:** $ \\Lambda$の基底を$ \\left\\{b_1,b_2,\\cdots,b_n\\right\\}$とし，そのグラムシュミットベクトルを$ b_1^*,\\cdots,b_n^*$とする．この時，自然数$ 1 \\leq i \\leq n$に対し$ \\| b_i^* \\| \\leq \\| b_i \\|$なので，$ \\| b_1^* \\| \\| b_2^* \\| \\cdots \\| b_n^* \\| \\leq \\|b_1\\| \\|b_2\\| \\cdots \\|b_n\\|$となる．従って定理4.2より，$ \\det \\Lambda \\leq \\prod ^{n}_{i=1} \\| b_{i} \\|$となる．$ ■$  ### 5. Lagrangeの方法 **定義 5.1:** 格子の基底$ \\left\\{ b_1, b_2 \\right\\} \\in \\mathbb{R}^{m \\times 2}$が任意の$ x \\in \\mathbb{Z}$に対し次の条件を満たすとき，**簡約されている**という．$ \\|b_1\\| \\leq \\|b_2\\| \\leq \\|b_2+xb_1\\|$また，簡約されている基底のことを**簡約基底**と呼ぶ．ある格子の簡約基底は，同じ格子を張るような基底の中で直交欠陥が最も$ 1$に近く，各ベクトルが短い基底です．また，ある格子が与えられたときその簡約基底を求めることを**簡約化**と言います．基底の簡約化は次のような性質から，最も長さの短い格子ベクトルの計算に用いられます．**定理 5.1:** 二次元の格子$ \\Lambda$の簡約基底を$ \\left\\{b_1,b_2\\right\\} \\in \\mathbb{R}^{m \\times 2}$とし，逐次最小を$ \\lambda_1,\\lambda_2$とする．この時次の式が成り立つ．$ \\|b_1\\| = \\lambda_1,\\ \\|b_2\\| = \\lambda_2$**証明:** 適当な格子ベクトル$ v = l_1b_1 + l_2b_2 \\neq 0$を考える．$ l_2 = 0$なら$ \\|v\\| \\geq \\|b_1\\|$となり，また$ l_2 \\neq 0$の時は，$ l_1 = ql_2 + r,\\ q,r \\in \\mathbb{Z},\\ 0 \\leq r \u0026lt; |l_2|$と書けば$ v = rb_1 + l_2(b_2 + qb_1)$である．従って，$ \\displaystyle \\begin{eqnarray} \\|v\\| \u0026amp;\\geq\u0026amp; |l_2|\\|b_2 + qb_1\\| - r\\|b_1\\|\\\\ \u0026amp;=\u0026amp; (|l_2| - r)\\|b_2+qb_1\\| + r(\\|b_2 + qb_1\\| - \\|b_1\\|)\\\\ \u0026amp;\\geq\u0026amp; \\|b_2 + qb_1\\|\\\\ \u0026amp;\\geq\u0026amp; \\|b_2\\| \\geq \\|b_1\\| \\end{eqnarray}$よって示された．$■$また，簡約であることと同値な次の条件を考えれば，具体的にどんなベクトルによって構成されるか考えやすくなると思います．**定理 5.2:** 二次元の格子$ \\Lambda$の基底$ \\left\\{b_1,b_2 \\right\\} \\in \\mathbb{R}^{m \\times 2}$が簡約基底であるための必要十分条件は次の式を満たすことである．$ \\|b_1\\| \\leq \\|b_2\\| \\leq \\|b_2 \\pm b_1\\|$**証明:** まず$ b_1,b_2$が簡約されていると仮定する．定義5.1において$ x = \\pm 1$とすれば$ \\|b_1\\| \\leq \\|b_2\\| \\leq \\|b_2 \\pm b_1\\|$． 次に$ b_1,b_2$が$ \\|b_1\\| \\leq \\|b_2\\| \\leq \\|b_2 \\pm b_1\\|$を満たすと仮定する．ここで，関数$ f(\\mu) = \\|b_2 + \\mu b_1 \\|^2 = \\|b_2\\|^2 - 2\\mu \\langle b_1,b_2 \\rangle + \\mu^2\\|b_1\\|^2$の最小値が$ -1 \u0026lt; \\mu \u0026lt; 1$の時取られることを考えれば，$ f(\\mu)$は二次関数なので$ |x|  1$を満たす整数$ x$に対し$ f(0) \\leq f(x)$となり，同じ$ x$に対し$ \\|b_2\\| \\leq \\|b_2 + xb_1 \\|$となる．従って仮定より任意の$ x \\in \\mathbb{Z}$に対し$ \\|b_1\\| \\leq \\|b_2\\| \\leq \\|b_2 + xb_1\\|$が成り立つ．よって示された．$■$基底の簡約化は一般には難しい問題です．ところが二次元の場合は，厳密解が多項式時間で求まるLagrangeの方法というアルゴリズムが存在し，具体的には次のような操作で簡約することができます．    $ 7$行目の$ \\mu_{2, 1}$は，$ \\|b_2 - \\mu_{2,1}b_1 \\|^2$が最小となるような$ b_1$の係数を設定していることに注意してください．$ \\mu_{2,1}$の最小値は，下に凸な二次関数$ \\|b_2 - \\mu_{2,1}b_1 \\|^2 = \\|b_2\\|^2 - 2\\mu_{2,1} \\langle b_1,b_2 \\rangle + \\mu_{2,1}^2\\|b_1\\|^2$の最小値でもあるので，適当に微分して$ -2\\langle b_{1} ,b_{2} \\rangle +2\\mu _{2,1} \\| b_{1} \\| ^{2} =0$の解を求めれば$ \\mu_{2, 1} = \\langle b1, b2 \\rangle / \\|b_1\\|^2$が導けます．つまり，二つのベクトルの差のノルムができるだけ短くなるように計算しているだけです．  ### 6. LLL簡約基底とサイズ簡約 Lagrangeの方法は，二次元の格子の簡約しかできない代わりに厳密解が求まるアルゴリズムでした．それに対しLLL(Lenstra–Lenstra–Lovász)アルゴリズムは，一般の次元に対して簡約基底の近似が行えます．ということで，そもそもの簡約基底の近似とはどういったものなのかちゃんと定義しておきます．**定義 6.1:** 格子$ \\Lambda$の基底$ \\left\\{ b_1,\\cdots,b_n \\right\\} \\in \\mathbb{R}^{m \\times n}$とそのグラムシュミットベクトル$ b_1^*,\\cdots,b_n^* \\in \\mathbb{R}^{m \\times n}$について，ある$ \\delta \\in \\mathbb{R}\\ (\\frac{1}{4} \u0026lt; \\delta \u0026lt; 1)$を用いて次の条件が成り立つとき，基底がパラメータ$ \\delta$で**LLL簡約されている**という．  自然数$ 1 \\leq j \u0026lt; i \\leq n$について$ |\\mu_{i,j}| \\leq \\frac{1}{2}$ (サイズ簡約) 自然数$ 1 \\leq i\u0026lt; n$について$ (\\delta - \\mu_{i+1, i}^2)\\|b_i^*\\|^2 \\leq \\|b_{i+1}^*\\|^2$ (Lovászの条件) 一つ目の条件はLLL以外の格子アルゴリズムでも度々出てきます．また，この条件を満たす基底を**サイズ簡約されている**と言います．また二つ目の条件はLovászの条件と呼ばれ，これのおかげで簡約の定義を緩めることができます．次に，格子の基底が与えられたとき，グラムシュミットベクトルを変えないようにサイズ簡約された基底を作るアルゴリズムを示します．これを使えばサイズ簡約の条件を簡単に達成できます．   **補題 6.1:** 格子$ \\Lambda$の基底を$ \\left\\{b_1,\\cdots,b_n \\right\\} \\in \\mathbb{R}^{m \\times n}$とし，そのグラムシュミット係数を$ \\mu_{i,j}\\ (1\\leq j \u0026lt; i \\leq n)$，グラムシュミットベクトルを$ b_1^*,\\cdots,b_n^*$とする．また，Algorithm 3でこの格子の基底をサイズ簡約したとき得られるベクトルの組を$ \\left\\{ b_1\u0026#39;,\\cdots,b_n\u0026#39; \\right\\}$とし，二重ループの内側でベクトルを張りなおした時のベクトルの組を$ 1 \\leq j \u0026lt; i \\leq n$に対して$ \\{ b_{i,j,1}\u0026#39;,\\cdots,b_{i,j,n}\u0026#39; \\}$とする．つまり$ b_{i,j,i}\u0026#39; = b_i - \\lfloor \\mu _{i,j} \\rceil b_{j} ,\\ b_{k} \u0026#39;=b_{k} \\ ( k\\neq i)$． また，$ \\{ b_{i,j,1}\u0026#39;,\\cdots,b_{i,j,n}\u0026#39; \\}$のグラムシュミットベクトルを$ b_{i,j,1}\u0026#39;^*,\\cdots,b_{i,j,n}\u0026#39;^*$とし，そのグラムシュミット係数を$ \\nu _{i,j,k,l} \\ ( 1\\leq l\u0026lt; k\\leq n)$としたとき，次の式が成り立つ．  自然数$ 1 \\leq k \\leq n$に対し$ b^{\\prime *}_{i,j,k} =b^{*}_{k}$ 自然数$ 1 \\leq l \\leq j$に対し$ \\nu _{i,j,i,l} =\\mu _{i,l} -\\lfloor \\mu _{i,j} \\rceil \\mu _{j,l}$で，特に$ |\\nu _{i,j,i,j} |\\leq \\frac{1}{2}$となる． その他のグラムシュミット係数に変化はない． **証明:** 一つ目の式は$ \\mathrm{span}( b_{k} ,\\cdots ,b_{n})$及び$ \\mathrm{span}( b\u0026#39;_{i,j,k} ,\\cdots ,b_{i,j,n})$への射影を考えれば明らかなので，二つ目の式のみ示す． 定義より，$ \\displaystyle \\nu _{i,j,i,l} = \\frac{\\langle b\u0026#39;_{i,j,i} ,b^{\\prime *}_{i,j,l} \\rangle }{\\langle b^{\\prime *}_{i,j,l} ,b^{\\prime *}_{i,j,l} \\rangle }=\\frac{\\langle b_{i} -\\lfloor \\mu _{i,j} \\rceil b_{j} ,b^{*}_{l} \\rangle }{\\| b^{*}_{l} \\| ^{2}}=\\mu _{i.l} -\\lfloor \\mu _{i,j} \\rceil \\mu _{j,l}$である．$ |\\nu _{i,j,i,j} |=|\\mu _{i.j} -\\lfloor \\mu _{i,j} \\rceil \\mu _{j,j} |=|\\mu _{i,j} -\\lfloor \\mu _{i,j} \\rceil |$なので，四捨五入の性質より$ |\\nu _{i,j,i,j} | \\leq \\frac{1}{2}$が成り立つ． また，その他のグラムシュミット係数が変化しないことは$ b_{i,j,k} \u0026#39;=b_{k} \\ ( k\\neq i)$より明らかである．$■$補題6.1より，Algorithm 3の正当性を確認することができました．また，補題6.1の1つ目の式から，Algorithm 3の6行目の処理は2つ目の式を使ってグラムシュミット係数のみ計算すればいいことがわかります．しかしここでは簡単のため，グラム・シュミットの直交化をするようにしています．この部分の最適化は，LLLの説明が終わった後の最適化の部分に纏めて書いてあるので安心してください．  ### 7. Lovászの条件 LLL簡約のLovászの条件は$ \\|b_{i+1}^*\\|^2 + \\mu_{i+1, i}^2 \\|b_i^*\\|^2 = \\|b_{i+1}^* + \\mu_{i+1,i}b_i^*\\|^2$でしたが，次のような式に書き換えることもできます．$ \\delta \\|b_i^*\\|^2 \\leq \\|b_{i+1}^* + \\mu_{i+1,i}b_i^*\\|^2$ここで正射影$ \\pi_i: \\mathbb{R}^m \\to \\mathrm{span}( b_i^* , \\cdots , b_n^* )$を考えてみます．具体的には$ \\displaystyle \\pi_i(x) = \\sum_{j=i}^n \\frac{\\langle x,b_j^* \\rangle}{\\langle b_j^*,b_j^* \\rangle}b_j^*$となります．これを用いればLovászの条件は，$ \\delta \\|\\pi_i(b_i)\\|^2 \\leq \\|\\pi_i(b_{i+1})\\|^2$となることがわかります．この式からもわかるように，この条件は，基底の簡約の条件$ b_i \\leq b_{i+1}$を$ \\delta$を用いて緩和したものと同じようなものになります． また，サイズ簡約の条件より，$ \\alpha = \\frac{1}{\\delta - 1 / 4}$としたとき自然数$ 1 \\leq j \\leq i \\leq n$について$ \\|b_j^*\\|^2 \\leq \\alpha^{i-j}\\|b_i^*\\|^2$となります．この式はLovászの条件がどの程度簡約の条件を緩めるかを意味するものになっています．**定理 7.1:** 格子$ \\Lambda$の基底行列を$ B=\\begin{pmatrix} b_{1} \u0026amp; \\cdots \u0026amp; b_{n} \\end{pmatrix} \\in \\mathbb{R}^{m \\times n}$とし，そのグラムシュミットベクトルによる行列を$ B^*=\\begin{pmatrix} b_{1}^* \u0026amp; \\cdots \u0026amp; b_{n}^* \\end{pmatrix}$とする．この時，格子$ \\Lambda$の逐次最小$ \\lambda_1$について次の不等式が成り立つ．$ \\lambda_1 \\geq \\min_i \\|b_i^*\\|$**証明:** $ \\displaystyle \\lambda_1 \\in \\left\\{ \\|Bx\\| \\mathrel{}\\middle|\\mathrel{} x \\in \\mathbb{Z}^n \\setminus \\left\\{0\\right\\} \\right\\}$なので，任意の$ x = \\begin{pmatrix} x_{1} \u0026amp; \\cdots \u0026amp; x_{n} \\end{pmatrix} \\in \\mathbb{Z}^n \\setminus \\left\\{0\\right\\}$に対し$ \\|Bx\\| \\geq \\min_i \\|b_i^*\\|$を示せばよい． まず$ k$を$ x_k \\neq 0$となる$ x$の最大のインデックスとする．この時$ Bx$と$ b_k^*$の内積を取ると$ \\displaystyle \\begin{aligned} \\langle Bx,b^{*}_{k} \\rangle \u0026amp; =\\langle \\sum ^{k}_{i=1} x_{i} b_{i} ,b^{*}_{k} \\rangle \\\\ \u0026amp; =\\sum ^{k}_{i=1} \\langle x_{i} b_{i} ,b^{*}_{k} \\rangle \\\\ \u0026amp; =\\langle x_{k} b_{k} ,b^{*}_{k} \\rangle \\\\ \u0026amp; =x_{k} \\| b^{*}_{k} \\| ^{2} \\end{aligned} $となる．よってコーシー・シュワルツの不等式より，$ \\|Bx\\| \\|b_k^*\\| \\geq | \\langle Bx, b_k^* \\rangle | = |x_k| \\|b_k^*\\|^2$となり，$ |x_k| \\geq 1$より$ \\|Bx\\| \\geq \\|b_k^*\\| \\geq \\min_i \\|b_i^*\\|$が成り立つ．よって示された．$■$**定理 7.2:** パラメータ$ \\delta$でLLL簡約された基底$ \\left\\{b_1,\\cdots,b_n \\right\\}$とそのグラムシュミットベクトル$ b_1^*,\\cdots,b_n^* $について，$ \\alpha = \\frac{1}{\\delta - 1/4}$としたとき，$ 1 \\leq j \\leq i \\leq n$を満たす任意の自然数$ i,j$に対して次の不等式が成り立つ．$ \\displaystyle \\|b_j\\| \\leq \\alpha^{(i-1)/2}\\|b_i^*\\|$**証明:** まず，$ \\|b_i\\|^2\\ (1 \\leq i \\leq n)$に対して次の式が成り立つ．$ \\displaystyle \\begin{aligned} \\| b_{i} \\| ^{2} \u0026amp; =\\langle b_{i} ,b_{i} \\rangle \\\\ \u0026amp; =\\langle b^{*}_{i} +\\sum ^{i-1}_{j=1} \\mu _{i,j} b^{*}_{j} ,b^{*}_{i} +\\sum ^{i-1}_{j=1} \\mu _{i,j} b^{*}_{j} \\rangle \\\\ \u0026amp; =\\| b^{*}_{i} \\|^2 +\\sum ^{i-1}_{j=1} \\mu ^{2}_{i,j} \\| b^{*}_{j} \\| ^{2} \\end{aligned} $よって，$ \\|b_j^*\\|^2 \\leq \\alpha^{i-j}\\|b_i^*\\|^2$とサイズ簡約の条件を用いれば$ \\displaystyle \\begin{aligned} \\| b_{i} \\| ^{2} \u0026amp; \\leq \\| b^{*}_{i} \\| ^{2} +\\frac{1}{4}\\sum ^{i-1}_{j=1} \\alpha ^{i-j} \\| b_{i} \\| ^{2}\\\\ \u0026amp; =\\| b^{*}_{i} \\| ^{2} +\\frac{1}{4} \\| b_{i} \\| ^{2}\\frac{\\alpha ^{i} -\\alpha }{\\alpha -1} \\end{aligned} $となる．従って，$ \\displaystyle \\| b_{i} \\| ^{2} \\leq \\| b^{*}_{i} \\| ^{2}\\left( 1+\\frac{1}{4}\\frac{\\alpha ^{i} -\\alpha }{\\alpha -1}\\right)$が成り立つ． ここで$ j \\geq 1$とすると$ \\displaystyle 1+\\frac{1}{4}\\frac{\\alpha ^{j} -\\alpha }{\\alpha -1} \\leq \\alpha ^{j-1}$なので，$ 1 \\leq j \\leq i \\leq n$に対して$ \\displaystyle \\begin{aligned} \\| b_{j} \\| ^{2} \u0026amp; \\leq \\alpha ^{j-1} \\| b^{*}_{j} \\| ^{2}\\\\ \u0026amp; \\leq \\alpha ^{j-1} \\alpha ^{i-j} \\| b^{*}_{i} \\| ^{2}\\\\ \u0026amp; =\\alpha ^{i-1} \\| b^{*}_{i} \\| ^{2} \\end{aligned} $従って$ \\displaystyle \\| b_{j} \\| \\leq \\alpha ^{( i-1) /2} \\| b^{*}_{i} \\| $が得られる．$■$これらの定理より，LLLによる最短格子ベクトルの近似の精度を与える不等式が得られます．**定理 7.3:** 格子$ \\Lambda$の，パラメータ$ \\delta$によるLLL簡約基底$ \\left\\{ b_1, \\cdots, b_n \\right\\}$と逐次最小$ \\lambda_1$について，$ \\alpha = \\frac{1}{\\delta - 1/4}$としたとき次の不等式が成り立つ．$ \\displaystyle \\|b_1\\| \\leq \\alpha^{(n-1)/2}\\lambda_1$**証明:** $ 1 \\leq i \\leq n$なる自然数$ i$について，定理7.2より$ \\displaystyle \\alpha ^{( 1-i) /2} \\| b^{*}_{1} \\| \\leq \\ \\| b^{*}_{i} \\| $したがって，定理7.1より$ \\displaystyle \\begin{aligned} \\lambda _{1} \u0026amp; \\geq \\min_i \\| b^{*}_{i} \\| \\\\ \u0026amp; \\geq \\min_i \\alpha ^{( 1-i) /2} \\| b^{*}_{1} \\| \\\\ \u0026amp; =\\alpha ^{( 1-n) /2} \\| b^{*}_{1} \\| \\end{aligned} $従って，$ b_1^* = b_1$より$\\| b_{1} \\| \\leq \\alpha ^{( n-1) /2} \\lambda _{1}$が得られる．$■$**定理 7.4:** 格子$ \\Lambda$の，パラメータ$ \\delta$によるLLL簡約基底$ \\left\\{ b_1, \\cdots, b_n \\right\\}$について，$ \\alpha = \\frac{1}{\\delta - 1/4}$としたとき次の不等式が成り立つ．$ \\|b_1\\| \\leq \\alpha^{(n-1)/4} \\det( \\Lambda) ^ {1/n}$**証明:** 定理7.2より，$ \\displaystyle \\begin{aligned} \\begin{aligned} \\| b_{1} \\| ^{n} \\end{aligned} \u0026amp; \\leq \\prod ^{n}_{i=1} \\alpha ^{( i-1) /2} \\| b^{*}_{i} \\| \\\\ \u0026amp; =\\alpha ^{n( n-1) /4}\\det \\Lambda \\end{aligned} $である．従って，$ \\| b_{1} \\| \\leq \\alpha ^{( n-1) /4}\\det( \\Lambda )^{1/n}$．$■$  ### 8. LLL簡約と計算量 遂にLLL簡約です．といってもここまで読めた方にとってはあまり難しくないと思います．実はLLLアルゴリズムは意外と単純で，サイズ簡約した後Lovászの条件を満たすか確認し，もし満たさなかったときはそのベクトルの組を入れ替えてやり直すことを繰り返すアルゴリズムなのです． 下に愚直な疑似コードを示します．    さすがに愚直が過ぎるので，ある程度無駄な計算を省いたものとして下のコードも示しておきます．主な解析はこっちのコードで行います．   LLLアルゴリズムにおいて，Lovászの条件を満たさなかったときの基底ベクトルの交換は次の補題から有効性が確認できます．**補題 8.1:** Algorithm 5の12行目にて，ベクトル$ b_k$と$ b_{k-1}$をを交換する前の基底を$ \\left\\{b_1,\\cdots,b_n\\right\\}$，交換した直後の基底を$ \\left\\{b_1\u0026#39;,\\cdots,b_n\u0026#39;\\right\\}$とし，それぞれのグラムシュミットベクトルを$ b_1^*,\\cdots,b_n^*$及び$ b_1\u0026#39;^*,\\cdots,b_n\u0026#39;^*$とする．このとき，次の式が成り立つ．  $ n$以下の自然数$ i \\neq k,k-1$に対し，$ b_{i} ^{\\prime *} =b^{*}_{i}$ $ \\displaystyle b^{\\prime *}_{k-1} =b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1} ,\\ \\| b^{\\prime *}_{k-1} \\| ^{2} =\\| b^{*}_{k} \\| ^{2} +\\mu ^{2}_{k,k-1} \\| b^{*}_{k-1} \\| ^{2}$ $ \\displaystyle b^{\\prime *}_{k} =\\frac{\\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k-1} -\\mu _{k,k-1} \\frac{\\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k} ,\\ \\| b^{\\prime *}_{k} \\| ^{2} =\\frac{\\| b^{*}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}}$ **証明:** 自然数$ 1 \\leq j \u0026lt; i \\leq n$に対し，グラムシュミットベクトル$ b_1^*,\\cdots,b_n^*$のグラムシュミット係数を$ \\mu_{i,j}$，$ b_1\u0026#39;^*,\\cdots,b_n\u0026#39;^*$のグラムシュミット係数を$ \\mu_{i,j}\u0026#39;$とする． $ b_k$と$ b_{k-1}$を交換しただけなので一つ目の式は明らかに成り立ち，また自然数$ 1 \\leq j \u0026lt; i \u0026lt; k-1$に対して$ \\mu_{i,j}\u0026#39; = \\mu_{i,j}$である． また，$ b^{\\prime *}_{k-1}$について$ \\displaystyle \\begin{aligned} b^{\\prime *}_{k-1} \u0026amp; =b^{\\prime }_{k-1} -\\sum ^{k-2}_{j=1} \\mu ^{\\prime }_{k-1,j} b^{\\prime *}_{j}\\\\ \u0026amp; =b_{k} -\\sum ^{k-2}_{j=1} \\mu _{k,j} b^{*}_{j}\\\\ \u0026amp; =b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1} \\end{aligned}$なので，そのノルムについて，$ \\| b^{\\prime *}_{k-1} \\| ^{2} =\\langle b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1} ,b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1} \\rangle =\\| b^{*}_{k} \\| ^{2} +\\mu ^{2}_{k,k-1} \\| b^{*}_{k-1} \\| ^{2}$となる． また，$ b^{\\prime *}_{k}$について$ \\displaystyle \\begin{aligned} b^{\\prime *}_{k} \u0026amp; =b^{\\prime }_{k} -\\sum ^{k-1}_{j=1} \\mu ^{\\prime }_{k,j} b^{\\prime *}_{j}\\\\ \u0026amp; =b_{k-1} -\\sum ^{k-2}_{j=1} \\mu _{k-1,j} b^{*}_{j} -\\mu ^{\\prime }_{k,k-1} b^{\\prime *}_{k-1}\\\\ \u0026amp; =b^{*}_{k-1} -\\frac{\\langle b_{k-1} ,b^{\\prime *}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{\\prime *}_{k-1}\\\\ \u0026amp; =b^{*}_{k-1} -\\frac{\\langle b_{k-1} ,b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2}}\\left( b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1}\\right)\\\\ \u0026amp; =b^{*}_{k-1} -\\frac{\\mu _{k,k-1} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}}\\left( b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1}\\right)\\\\ \u0026amp; =\\frac{\\| b^{\\prime *}_{k-1} \\| ^{2} -\\mu ^{2}_{k,k-1} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k-1} -\\frac{\\mu _{k,k-1} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k}\\\\ \u0026amp; =\\frac{\\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k-1} -\\mu _{k,k-1}\\frac{\\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k} \\end{aligned}$が成り立つため，そのノルムについて$ \\displaystyle \\begin{aligned} \\| b^{\\prime *}_{k} \\| \u0026amp; =\\frac{\\| b^{*}_{k} \\| ^{4} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{4}} +\\mu ^{2}_{k,k-1}\\frac{\\| b^{*}_{k-1} \\| ^{4} \\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{4}}\\\\ \u0026amp; =\\frac{\\| b^{*}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{4}}\\left( \\| b^{*}_{k} \\| ^{2} +\\mu ^{2}_{k,k-1} \\| b^{*}_{k-1} \\| ^{2}\\right)\\\\ \u0026amp; =\\frac{\\| b^{*}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} \\end{aligned}$となる．よって示された．$■$補題8.1より，元の基底のベクトル$ b_k$と$ b_{k-1}$がLovászの条件を満たさなかったとき，$ \\| b^{*}_{k} \\| ^{2} \u0026lt; ( \\delta -\\mu ^{2}_{k,k-1}) \\| b^{*}_{k-1} \\| ^{2}$なので，これを交換して得られた基底$ \\left\\{ b_1^{\\prime},\\cdots,b_n^{\\prime} \\right\\}$について$ \\|b_{k-1}^{\\prime *}\\|^2 \u0026lt; \\delta \\|b_{k-1}^*\\|^2$が成り立ちます．よって，Lovászの条件を満たさない基底ベクトル$ b_k,b_{k-1}$の交換は，$ \\|b_{k-1}^*\\|^2$を少なくとも$ \\delta$倍だけ短くする操作と同じものになります． では次にLLLの計算量を考えます．ただ，$ \\mathbb{R}^n$内の任意の格子に対する具体的な計算量を証明することができなかったので，整数格子限定の計算量しか解説できません．ごめんなさい……(てか既に厳密な計算量が与えられてるかすらわからなかったのです．強い人どうか教えてください) まずはLLLの停止性について次の定理が言えます．**定理 8.2:** 格子$ \\Lambda$の基底を$ \\left\\{ b_1,\\cdots,b_n \\right\\} \\in \\mathbb{Z}^{m \\times n}$とし，$ X = \\max_i \\|b_i\\|^2$とする．この時，Algorithm5で示される，パラメータ$ \\delta$によるLLLのwhile文中の処理は$ O\\left( n^{2}\\log X\\right)$程度の回数で停止する．**証明:** $ \\left\\{ b_1,\\cdots,b_n \\right\\}$のグラムシュミットベクトルを$ b_1^*,\\cdots,b_n^*$とする． いま，自然数$ 1 \\leq i \u0026lt; n$に対し$ B_{i} =\\begin{pmatrix} b_{1} \u0026amp; \\cdots \u0026amp; b_{i} \\end{pmatrix} \\in \\mathbb{Z}^{i \\times m}$とし，$ d_i = \\det\\left({}^t\\!B_iB_i\\right)$と置く．$ B_i$は整数行列なので$ d_i \\in \\mathbb{Z}$となり，また定理4.2より次の式が成り立つ．$ \\displaystyle d_{i} =\\prod ^{i}_{j=1} \\| b^{*}_{i} \\| ^{2} \\leq \\prod ^{i}_{j=1} \\| b_{i} \\| ^{2} \\leq X^{i}$ここで，$ \\displaystyle D=\\prod ^{n-1}_{i=1} d_{i} =\\prod ^{n-1}_{i=1} \\| b^{*}_{i} \\| ^{n-i}$としたとき，定義より次の式が成り立つ．$ \\displaystyle D=\\prod ^{n-1}_{i=1} \\| b^{*}_{i} \\| ^{n-i} \\leq \\prod ^{n-1}_{i=1} X^{n-i} =X^{n( n-1) /2}$ところで，Algorithm5において元の基底のベクトル$ b_k,b_{k-1}$がLovászの条件を満たさず，この二つを交換して新しい基底$ \\left\\{ b_1^{\\prime},\\cdots,b_n^{\\prime} \\right\\}$を作ったとする．この基底のグラムシュミットベクトルを$ b_1^{\\prime *},\\cdots,b_n^{\\prime *}$とし，新しい基底に対する$ d_i$を$ d_i^{\\prime}$とすれば，補題8.1より自然数$ 1 \\leq i \u0026lt; k-1$に対して$ d_i^{\\prime} = d_i$となる．さらにベクトルの交換により$ \\|b_{k-1}^{\\prime *}\\|^2 \\leq \\delta \\|b_{k-1}^*\\|^2$なので$ d_{k-1}^{\\prime} \\leq \\delta d_{k-1}$となり，また$ \\|b_{k-1}^{\\prime *}\\|^2 \\|b_k^{\\prime *}\\|^2 = \\|b_{k-1}^*\\|^2 \\|b_k^*\\|^2$より，自然数$ k \\leq i \\leq n$に対して$ d_i^{\\prime} = d_i$である．従って，基底ベクトルの交換により$ D$の値も少なくとも$ \\delta$倍小さくなることがわかる．ゆえに，Algorithm5における基底ベクトルの交換の回数を$ N$とすれば$ 1 \\leq \\delta^N D$なので，$ \\displaystyle N\\leq \\log_{\\delta }\\frac{1}{D} =\\log_{1/\\delta } D\\leq \\log_{1/\\delta }\\left( X^{n( n-1) /2}\\right) =\\frac{n( n-1)}{2}\\log_{1/\\delta } X$となる．これより，基底ベクトルの交換の回数$ N$は$ O\\left( n^{2}\\log X\\right)$程度である．よって示された．$■$定理8.2を使えば，最終的なLLL(Algorithm 5)の計算量が簡単に求まります．**定理 8.3:** 格子$ \\Lambda$の基底を$ \\left\\{ b_1,\\cdots,b_n \\right\\} \\in \\mathbb{Z}^{m \\times n}$とし，$ X = \\max_i \\|b_i\\|^2$とする．この時，Algorithm5で示される，パラメータ$ 1/4 \u0026lt; \\delta \u0026lt; 1$によるLLL簡約全体の計算量は$ O\\left( n^{5}m\\log X\\right)$となる．**証明:** グラム・シュミットの直交化法の計算量は$ O(n^2m)$なので，3行目までの初期化の処理の計算量もまた$ O(n^2m)$である． また，4行目から15行目の繰り返し回数は定理8.2より$ O(n^2 \\log X)$程度であった．この中に，5行目から8行目までの$ O(n^3m)$の処理と，8行目から15行目までの$ O(n^2m)$の処理が含まれているため，メインのループ全体の計算量は$ O(n^2 \\log X \\cdot (n^3m + n^2m)) = O(n^5 m \\log X)$となる． よってAlgorithm 5全体の計算量は$ O(n^2m + n^5 m \\log X) = O(n^5 m \\log X)$となる．$■$  ### 9. 最適化 前にちょこちょこ書いていたように，Algorithm 5のLLLは無駄な計算があります．ということで，上で説明したAlgorithm 5の計算量をもう少し落としてみます．まずは8行目のグラム・シュミットの直交化の部分に注目します．補題6.1より，サイズ簡約を行ったあと出力されるベクトルは変わらないことが保証されているため，ここはグラムシュミット係数を更新するだけで済み，わざわざ直交化までする必要はありません．また，グラムシュミット係数の更新は補題6.1の二つ目の主張を利用すればよく，この部分の計算量を$ O(n^2m)$から$ O(n)$まで落とすことができます．具体的には，サイズ簡約を下のようなコードで書けばよいことになります．   次に，Algorithm 5の13行目のグラム・シュミットの直交化の部分に注目します．この部分はベクトルの交換が行われるためグラムシュミットベクトルを計算する必要があります．しかしグラム・シュミットの直交化を直接利用する必要はなく，補題8.1と次の補題を用いれば，交換する前の基底を利用して直交化することができます．**補題 9.1:** 格子$ \\Lambda$の基底を$ \\left\\{ b_1,\\cdots,b_n \\right\\} \\in \\mathbb{R}^{m \\times n}$とし，そのグラムシュミット係数を$ \\mu_{i,j}\\ (1 \\leq j \u0026lt; i \\leq n)$，グラムシュミットベクトルを$ b_1^*,\\cdots,b_n^*$とする．ここで，ある自然数$ 1 \u0026lt; k \\leq n$に対し$ b_k, b_{k-1}$の組がLovászの条件を満たさず，$ \\| b^{*}_{k} \\| ^{2} \u0026lt; ( \\delta -\\mu ^{2}_{k,k-1}) \\| b^{*}_{k-1} \\| ^{2}$であったとし，そのベクトルを交換して得られる基底を$ \\left\\{ b_1^{\\prime},\\cdots,b_n^{\\prime} \\right\\}$とする．またそのグラムシュミット係数を$ \\mu_{i,j}^{\\prime}\\ (1 \\leq j \u0026lt; i \\leq n)$と表し，グラムシュミットベクトルを$ b_1^{\\prime *},\\cdots,b_n^{\\prime *}$とする．この時以下の式が成り立つ．  $ \\displaystyle \\mu ^{\\prime}_{k,k-1} =\\frac{\\mu _{k,k-1} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}}$ 自然数$ 1 \\leq j \u0026lt; k-2$に対し，$ \\mu^{\\prime}_{k-1,j} =\\mu _{k,j} ,\\ \\mu^{\\prime}_{k,j} =\\mu _{k-1,j}$ 自然数$ k+1 \\leq j \\leq n$に対し，$ \\mu^{\\prime}_{j,k} =\\mu _{j,k-1} -\\mu _{k,k-1} \\mu _{j,k} ,\\ \\mu^{\\prime}_{j,k-1} =\\mu _{j,k} +\\mu^{\\prime}_{k,k-1} \\mu^{\\prime}_{j,k}$ 上の式の条件に当てはまらないグラムシュミット係数は変化しない． **証明:** まず，$ \\mu_{k,k-1}^{\\prime}$について補題8.1より次の式が成り立つ．$ \\displaystyle \\begin{array}{l} \\begin{aligned} \\mu ^{\\prime }_{k,k-1} \u0026amp; =\\frac{\\langle b^{\\prime }_{k} ,b^{\\prime *}_{k-1} \\rangle }{\\langle b^{\\prime *}_{k-1} ,b^{\\prime *}_{k-1} \\rangle }\\\\ \u0026amp; =\\frac{\\langle b_{k-1} ,b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\mu _{k,k-1} \\langle b_{k-1} ,b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\mu _{k,k-1} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} \\end{aligned} \\end{array}$また，自然数$ 1 \\leq j \u0026lt; k-1$について$ \\displaystyle \\begin{aligned} \\mu ^{\\prime }_{k-1,j} \u0026amp; =\\frac{\\langle b^{\\prime }_{k-1} ,b^{\\prime *}_{j} \\rangle }{\\| b^{\\prime *}_{j} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\langle b_{k} ,b^{*}_{j} \\rangle }{\\| b^{*}_{j} \\| ^{2}}\\\\ \u0026amp; =\\mu _{k,j} \\end{aligned}$であり，$ \\mu^{\\prime}_{k,j}$も同様に，$ \\displaystyle \\begin{aligned} \\mu ^{\\prime }_{k,j} \u0026amp; =\\frac{\\langle b^{\\prime }_{k} ,b^{\\prime *}_{j} \\rangle }{\\| b^{\\prime *}_{j} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\langle b_{k-1} ,b^{*}_{j} \\rangle }{\\| b^{*}_{j} \\| ^{2}}\\\\ \u0026amp; =\\mu _{k-1,j} \\end{aligned}$となる． さらに，自然数$ k+1 \\leq j \\leq n$についても同様に，$ \\displaystyle \\begin{aligned} \\mu ^{\u0026#39;}_{j,k} \u0026amp; =\\frac{\\langle b^{\\prime }_{j} ,b^{\\prime *}_{k} \\rangle }{\\| b^{\u0026#39;*}_{k} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\langle b_{j} ,\\frac{\\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k-1} -\\mu _{k,k-1}\\frac{\\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}} b^{*}_{k} \\rangle }{\\frac{\\| b^{*}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}}}\\\\ \u0026amp; =\\frac{\\langle b_{j} ,\\| b^{*}_{k} \\| ^{2} b^{*}_{k-1} -\\mu _{k,k-1} \\| b^{*}_{k-1} \\| ^{2} b^{*}_{k} \\rangle }{\\| b^{*}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| }\\\\ \u0026amp; =\\mu _{j,k-1} -\\mu _{k,k-1} \\mu _{j,k} \\end{aligned}$となり，$ \\mu_{j,k-1}^{\\prime}$についても$ \\displaystyle \\begin{aligned} \\mu ^{\u0026#39;}_{j,k-1} \u0026amp; =\\frac{\\langle b^{\\prime }_{j} ,b^{\\prime *}_{k-1} \\rangle }{\\| b^{\u0026#39;*}_{k-1} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\langle b_{j} ,b^{*}_{k} +\\mu _{k,k-1} b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\| b^{*}_{k} \\| ^{2} \\langle b_{j} ,b^{*}_{k} \\rangle +\\mu _{k,k-1} \\| b^{*}_{k} \\| ^{2} \\langle b_{j} ,b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\left( \\| b^{\\prime *}_{k-1} \\| ^{2} -\\mu ^{2}_{k,k-1} \\| b^{*}_{k-1} \\| ^{2}\\right) \\langle b_{j} ,b^{*}_{k} \\rangle +\\mu _{k,k-1} \\| b^{*}_{k} \\| ^{2} \\langle b_{j} ,b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\| b^{\\prime *}_{k-1} \\| ^{2} \\langle b_{j} ,b^{*}_{k} \\rangle -\\mu ^{2}_{k,k-1} \\| b^{*}_{k-1} \\| ^{2} \\langle b_{j} ,b^{*}_{k} \\rangle +\\mu _{k,k-1} \\| b^{*}_{k} \\| ^{2} \\langle b_{j} ,b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\| b^{\\prime *}_{k-1} \\| ^{2} \\langle b_{j} ,b^{*}_{k} \\rangle +\\mu _{k,k-1} \\| b^{*}_{k} \\| ^{2} \\langle b_{j} ,b^{*}_{k-1} \\rangle -\\mu _{k,k-1} \\langle b_{k} ,b^{*}_{k-1} \\rangle \\langle b_{j} ,b^{*}_{k} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\| b^{\\prime *}_{k-1} \\| ^{2} \\langle b_{j} ,b^{*}_{k} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}} +\\frac{\\mu _{k,k-1} \\| b^{*}_{k} \\| ^{2} \\langle b_{j} ,b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}} -\\frac{\\mu _{k,k-1} \\langle b_{j} ,b^{*}_{k} \\rangle \\langle b_{k} ,b^{*}_{k-1} \\rangle }{\\| b^{\\prime *}_{k-1} \\| ^{2} \\| b^{*}_{k} \\| ^{2}}\\\\ \u0026amp; =\\frac{\\langle b_{j} ,b^{*}_{k} \\rangle }{\\| b^{*}_{k} \\| ^{2}} +\\frac{\\mu _{k,k-1} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}}\\frac{\\langle b_{j} ,b^{*}_{k-1} \\rangle }{\\| b^{*}_{k-1} \\| ^{2}} -\\frac{\\mu _{k,k-1} \\| b^{*}_{k-1} \\| ^{2}}{\\| b^{\\prime *}_{k-1} \\| ^{2}}\\frac{\\langle b_{k} ,b^{*}_{k-1} \\rangle }{\\| b^{*}_{k-1} \\| ^{2}}\\frac{\\langle b_{j} ,b^{*}_{k} \\rangle }{\\| b^{*}_{k} \\| ^{2}}\\\\ \u0026amp; =\\mu _{j,k} +\\mu ^{\\prime }_{k,k-1} \\mu _{j,k-1} -\\mu ^{\\prime }_{k,k-1} \\mu _{k,k-1} \\mu _{j,k}\\\\ \u0026amp; =\\mu _{j,k} +\\mu ^{\\prime }_{k,k-1}( \\mu _{j,k-1} -\\mu _{k,k-1} \\mu _{j,k})\\\\ \u0026amp; =\\mu _{j,k} +\\mu ^{\\prime }_{k,k-1} \\mu ^{\\prime }_{j,k} \\end{aligned}$となる． 他のグラムシュミット係数については，$ b_k$と$ b_{k-1}$しか交換してないことから変化しないことは明らかである．よって示された．$■$補題9.1の結果を用いれば，Algorithm 5の13行目のグラム・シュミットの直交化を$ O(n)$の処理で置き換えることができ，最終的にLLL全体は次のようになります．    ちなみにこのLLLの計算量は，定理8.3の記号を用いれば$ O(n^3 m \\log X)$です．早くなった！ LLLの最適化は現在も研究されている分野で，例えばDeepLLLやSegmentLLLなど，色々な種類のLLLが開発されています．これを見てLLLに興味を持った人は，ぜひ勉強して完全理解して自分に教えてください．  ","description":"","id":1,"section":"posts","tags":[],"title":"LLLを理解するぞ","uri":"https://mitsu1119.github.io/blog/posts/post2/lll/"}]