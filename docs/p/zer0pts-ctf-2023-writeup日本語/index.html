<!DOCTYPE html>
<html lang="ja" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='$$ \gdef\Fp {\mathbb{F} _ p} \gdef\LB{\mathrm{LB} _ l} \gdef\RB{\mathrm{RB} _ r} $$
ã¯ã˜ã‚ã« ãƒãƒ¼ãƒ  zer0pts ã¯ï¼Œä»Šå¹´ã® 7/15 ã« zer0pts ctf 2023 ã‚’é–‹å‚¬ã—ã¾ã—ãŸï¼ å¤šãã®æ–¹ã€…ã«å‚åŠ ã—ã¦ã„ãŸã ã„ã¦æ„Ÿè¬ã—ã¦ãŠã‚Šã¾ã™ï¼
åƒ•ã¯æœ¬ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã§ crypto ã‚¸ãƒ£ãƒ³ãƒ«ã®å•é¡Œã‚’ 4ã¤ä½œæˆã—ã¾ã—ãŸï¼ã“ã“ã§ã¯ä½œè€…ã®æƒ³å®šã—ã¦ã„ãŸè§£æ³•ã‚’è§£èª¬ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼
[crypto 102pts] easy_factoring (95 solves) Overview The word â€œdecompositionâ€ has multiple meanings.
Can you decompose?
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 def main(): p = getPrime(128) q = getPrime(128) n = p * q N = pow(p, 2) &#43; pow(q, 2) print(&amp;#34;Let&amp;#39;s factoring !'>
<title>zer0pts ctf 2023 writeupï¼ˆæ—¥æœ¬èªï¼‰</title>

<link rel='canonical' href='https://mitsu1119.github.io/blog/p/zer0pts-ctf-2023-writeup%E6%97%A5%E6%9C%AC%E8%AA%9E/'>

<link rel="stylesheet" href="/blog/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content='zer0pts ctf 2023 writeupï¼ˆæ—¥æœ¬èªï¼‰'>
<meta property='og:description' content='$$ \gdef\Fp {\mathbb{F} _ p} \gdef\LB{\mathrm{LB} _ l} \gdef\RB{\mathrm{RB} _ r} $$
ã¯ã˜ã‚ã« ãƒãƒ¼ãƒ  zer0pts ã¯ï¼Œä»Šå¹´ã® 7/15 ã« zer0pts ctf 2023 ã‚’é–‹å‚¬ã—ã¾ã—ãŸï¼ å¤šãã®æ–¹ã€…ã«å‚åŠ ã—ã¦ã„ãŸã ã„ã¦æ„Ÿè¬ã—ã¦ãŠã‚Šã¾ã™ï¼
åƒ•ã¯æœ¬ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã§ crypto ã‚¸ãƒ£ãƒ³ãƒ«ã®å•é¡Œã‚’ 4ã¤ä½œæˆã—ã¾ã—ãŸï¼ã“ã“ã§ã¯ä½œè€…ã®æƒ³å®šã—ã¦ã„ãŸè§£æ³•ã‚’è§£èª¬ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼
[crypto 102pts] easy_factoring (95 solves) Overview The word â€œdecompositionâ€ has multiple meanings.
Can you decompose?
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 def main(): p = getPrime(128) q = getPrime(128) n = p * q N = pow(p, 2) &#43; pow(q, 2) print(&amp;#34;Let&amp;#39;s factoring !'>
<meta property='og:url' content='https://mitsu1119.github.io/blog/p/zer0pts-ctf-2023-writeup%E6%97%A5%E6%9C%AC%E8%AA%9E/'>
<meta property='og:site_name' content='ã¿ã¤ã¿ã¤ã¿ã¤ã§ã™ã‹ï¼Ÿ'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='elliptic curve' /><meta property='article:tag' content='math' /><meta property='article:tag' content='writeup' /><meta property='article:published_time' content='2023-07-18T05:15:52&#43;09:00'/><meta property='article:modified_time' content='2023-07-18T05:15:52&#43;09:00'/>
<meta name="twitter:title" content="zer0pts ctf 2023 writeupï¼ˆæ—¥æœ¬èªï¼‰">
<meta name="twitter:description" content="$$ \gdef\Fp {\mathbb{F} _ p} \gdef\LB{\mathrm{LB} _ l} \gdef\RB{\mathrm{RB} _ r} $$
ã¯ã˜ã‚ã« ãƒãƒ¼ãƒ  zer0pts ã¯ï¼Œä»Šå¹´ã® 7/15 ã« zer0pts ctf 2023 ã‚’é–‹å‚¬ã—ã¾ã—ãŸï¼ å¤šãã®æ–¹ã€…ã«å‚åŠ ã—ã¦ã„ãŸã ã„ã¦æ„Ÿè¬ã—ã¦ãŠã‚Šã¾ã™ï¼
åƒ•ã¯æœ¬ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã§ crypto ã‚¸ãƒ£ãƒ³ãƒ«ã®å•é¡Œã‚’ 4ã¤ä½œæˆã—ã¾ã—ãŸï¼ã“ã“ã§ã¯ä½œè€…ã®æƒ³å®šã—ã¦ã„ãŸè§£æ³•ã‚’è§£èª¬ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼
[crypto 102pts] easy_factoring (95 solves) Overview The word â€œdecompositionâ€ has multiple meanings.
Can you decompose?
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 def main(): p = getPrime(128) q = getPrime(128) n = p * q N = pow(p, 2) &#43; pow(q, 2) print(&amp;#34;Let&amp;#39;s factoring !">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-VQ0SEQSRZ0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VQ0SEQSRZ0');
</script>



    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ããƒ»é–‰ã˜ã‚‹">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/blog">
                
                    
                    
                    
                        
                        <img src="/blog/images/avatar_hu6d5cebf05e4ae7675a69c338dfe93e72_520761_300x0_resize_box_3.png" width="300"
                            height="291" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ§</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/blog">ã¿ã¤ã¿ã¤ã¿ã¤ã§ã™ã‹ï¼Ÿ</a></h1>
            <h2 class="site-description">ã¯ã„</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/mitsu1119'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/meowricator'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®æ¬¡</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«</a></li>
    <li><a href="#crypto-102pts-easy_factoring-95-solves">[crypto 102pts] easy_factoring (95 solves)</a>
      <ol>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#solution">Solution</a></li>
      </ol>
    </li>
    <li><a href="#crypto-178pts-elliptic-ring-rsa-27-solves">[crypto 178pts] Elliptic Ring RSA (27 solves)</a>
      <ol>
        <li><a href="#overview-1">Overview</a></li>
        <li><a href="#solution-1">Solution</a></li>
      </ol>
    </li>
    <li><a href="#crypto-226pts-moduhash-16-solves">[crypto 226pts] moduhash (16 solves)</a>
      <ol>
        <li><a href="#overview-2">Overview</a></li>
        <li><a href="#solution-2">Solution</a></li>
      </ol>
    </li>
    <li><a href="#crypto-340pts-unlimited-braid-works-6-solves">[crypto 340pts] Unlimited Braid Works (6 solves)</a>
      <ol>
        <li><a href="#overview-3">Overview</a></li>
        <li><a href="#solution-3">Solution</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/blog/p/zer0pts-ctf-2023-writeup%E6%97%A5%E6%9C%AC%E8%AA%9E/">zer0pts ctf 2023 writeupï¼ˆæ—¥æœ¬èªï¼‰</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jul 18, 2023</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>$$
\gdef\Fp {\mathbb{F} _ p}
\gdef\LB{\mathrm{LB} _ l}
\gdef\RB{\mathrm{RB} _ r}
$$</p>
<h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«</h2>
<p>ãƒãƒ¼ãƒ  <a class="link" href="https://zer0pts.com/"  target="_blank" rel="noopener"
    >zer0pts</a> ã¯ï¼Œä»Šå¹´ã® 7/15 ã« <a class="link" href="https://ctftime.org/event/1972/"  target="_blank" rel="noopener"
    >zer0pts ctf 2023</a> ã‚’é–‹å‚¬ã—ã¾ã—ãŸï¼
å¤šãã®æ–¹ã€…ã«å‚åŠ ã—ã¦ã„ãŸã ã„ã¦æ„Ÿè¬ã—ã¦ãŠã‚Šã¾ã™ï¼</p>
<p>åƒ•ã¯æœ¬ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã§ crypto ã‚¸ãƒ£ãƒ³ãƒ«ã®å•é¡Œã‚’ 4ã¤ä½œæˆã—ã¾ã—ãŸï¼ã“ã“ã§ã¯ä½œè€…ã®æƒ³å®šã—ã¦ã„ãŸè§£æ³•ã‚’è§£èª¬ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼</p>
<h2 id="crypto-102pts-easy_factoring-95-solves">[crypto 102pts] easy_factoring (95 solves)</h2>
<h3 id="overview">Overview</h3>
<blockquote>
<p>The word â€œdecompositionâ€ has multiple meanings.<br>
Can you decompose?</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Let&#39;s factoring !&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;N:&#34;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;p: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;q: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">==</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ãˆã‚‰ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã®ä¸­ã§ç‰¹ã«é‡è¦ãªéƒ¨åˆ†ã¯ä¸Šã®éƒ¨åˆ†ã§ã™ï¼<br>
$p,q$ ã‚’ 128 bits ã®ç´ æ•°ã¨ã—ï¼Œ$N := p^2 + q^2$ ãŒä¸ãˆã‚‰ã‚Œã¾ã™ï¼ã“ã®ã¨ã $p,q$ ã‚’ç™ºè¦‹ã™ã‚‹ã“ã¨ãŒã§ããŸã‚‰ãƒ•ãƒ©ã‚°ã‚’å–å¾—ã§ãã¾ã™ï¼<br>
easy_factoring ã¨ã„ã†å•é¡Œåã§ã™ãŒï¼Œã‚„ã‚‹ã“ã¨ã¯ç´ å› æ•°åˆ†è§£ã¨è¦‹ã›ã‹ã‘ã¦å¹³æ–¹å’Œã§ã®åˆ†è§£ã§ã™ï¼ï¼ˆã¨ã„ã£ã¦ã‚‚çµå±€ç´ å› æ•°åˆ†è§£ãŒå¿…è¦ã«ãªã‚Šã¾ã™ãŒï¼‰</p>
<h3 id="solution">Solution</h3>
<p>$N$ ã®å¹³æ–¹å’Œã§ã®åˆ†è§£ã¯ï¼Œã‚¬ã‚¦ã‚¹æ•´æ•°ç’° $\mathbb{Z}[i]$ ã§ $N$ ã®ç´ å…ƒåˆ†è§£ãŒã§ãã‚Œã°è§£ã‘ã¾ã™ï¼<br>
ä»Š $N$ ãŒã‚¬ã‚¦ã‚¹ç´ æ•° $\pi_1,\pi_2,\cdots,\pi_s$ ã‚’ç”¨ã„ã¦ $N = (\pi_1 \bar \pi_1)(\pi_2 \bar \pi_2)\cdots (\pi_s \bar \pi_s)$ ã¨æ›¸ã‘ã‚‹ã¨ã—ã¾ã™ï¼<br>
ã“ã®ã¨ã $N = a^2 + b^2$ ã¨ãªã‚‹ $a,b\in \mathbb{Z}$ ã«ã¤ã„ã¦ï¼Œ$N = (a + bi)(a - bi) = (\pi_1 \bar \pi_1)(\pi_2 \bar \pi_2)\cdots (\pi_s \bar \pi_s)$ ã¨ãªã‚Šã¾ã™ï¼</p>
<p>ã¤ã¾ã‚Š $N$ ã‚’å¹³æ–¹å’Œã«åˆ†è§£ã™ã‚‹ã‚ˆã†ãªæ•´æ•° $a,b$ ã¯ï¼Œ$a + bi$ ã¨ã—ã¦ $N$ ã® $\mathbb{Z}[i]$ ã§ã®å› æ•°ã«å«ã¾ã‚Œã¦ã„ã¾ã™ï¼<br>
ã¾ãŸã“ã‚Œã¯ $N$ ã‚’ $\mathbb{Z}[i]$ ã§ç´ å…ƒåˆ†è§£ã—ã¦ãã‚Œã‚‰ã®ç©ã®çµ„ã¿åˆã‚ã›ã‚’å…¨ã¦è¨ˆç®—ã™ã‚Œã°ï¼Œãã®ä¸­ã®å°‘ãªãã¨ã‚‚ä¸€ã¤ã¨ä¸€è‡´ã—ã¾ã™ï¼</p>
<p>ã‚ˆã£ã¦ã“ã®æ–¹æ³•ã§ $p,q$ ã‚’å¾©å…ƒã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼<br>
ã¨ã¯ã„ã£ã¦ã‚‚ $N$ ã®ç´ å…ƒåˆ†è§£ã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼ãã®ãŸã‚ä½•åº¦ã‹ã‚µãƒ¼ãƒã«æ¥ç¶šã—ã¦ï¼Œç°¡å˜ãª $N$ ãŒå‡ºã‚‹ã¾ã§ç¹°ã‚Šè¿”ã•ãªãã¦ã¯ã„ã‘ãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼</p>
<p>ã‚½ãƒ«ãƒã©ãº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s2">&#34;python&#34;</span><span class="p">,</span> <span class="s2">&#34;server.py&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="n">I</span><span class="p">](</span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()[</span><span class="mi">3</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">facs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">facs</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">facs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">facs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">facs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">prods</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">facs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">facs</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">mul</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">ZZ</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mul</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="ow">and</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">ZZ</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mul</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="ow">and</span> <span class="n">mul</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">==</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mul</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mul</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®Ÿã¯ã“ã‚“ãªé¢¨ã«é ‘å¼µã‚‰ãªãã¦ã‚‚ sagemath ã« <code>Divisor</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ã‚‰ã—ãï¼Œ<code>Divisor(ZZ[I](N))</code> ã§ $N$ ã®å› æ•°åˆ—æŒ™ãŒã§ãã‚‹ã‚‰ã—ã„ã§ã™ï¼<br>
ã¾ãŸåŒã˜ã sagemath ã« <code>two_squares</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Šï¼Œã“ã‚Œã‚’ä½¿ã£ã¦ã‚‚ $N$ ã‚’å¹³æ–¹å’Œã«åˆ†è§£ã§ãã‚‹ã‚ˆã†ã§ã™ï¼ï¼ˆã“ã‚Œã‚’ä½¿ã†å ´åˆã¯è§£ãŒä¸€ã¤ã—ã‹å‡ºãªã„ã®ã§ï¼ŒãŸã¾ãŸã¾å‡ºãŸè§£ãŒå¤§ããªç´ æ•°ã«ãªã‚‹ã¾ã§ä½•åº¦ã‚‚æ¥ç¶šã‚’ç¹°ã‚Šè¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰</p>
<p>ã•ã‚‰ã«ã•ã‚‰ã«ï¼Œæ™®é€šã«ãƒ‡ã‚£ã‚ªãƒ•ã‚¡ãƒ³ãƒˆã‚¹å•é¡Œã¨ã—ã¦ã¿ã¦ sympy ã®ãƒ‡ã‚£ã‚ªãƒ•ã‚¡ãƒ³ãƒˆã‚¹å•é¡Œã‚½ãƒ«ãƒã«ã‹ã‘ã‚‹ã ã§ã‚‚è§£ã‘ã‚‹ã‚ˆã†ã§ã™ï¼<br>
easy_factoring ã¯é›£æ˜“åº¦ã¨ã—ã¦ easy æƒ³å®šã ã£ãŸã®ã§è¢«å®³ã¯å°‘ãªã‹ã£ãŸã¨æ€ã„ã¾ã™ãŒï¼Œãã‚Œã§ã‚‚ãƒ„ãƒ¼ãƒ«ã«ã‹ã‘ã‚‹ã ã‘ã§è§£ã‘ã¡ã‚ƒã†ã‚¿ã‚¤ãƒ—ã®éæƒ³å®šè§£ãŒç”Ÿã¾ã‚Œã¦ã—ã¾ã£ãŸã®ã¯åçœã—ã¦ã„ã¾ã™ï¼ï¼ˆwarmup ã‚ˆã‚Š solves å¤šã„ã—ï¼‰<br>
å•é¡Œã®æ§‹æƒ³ã®æœ€åˆã®é ƒã¯å¹³æ–¹å’Œã®åˆ†è§£ã‚’ä½¿ã£ã¦ä½•ã‚‰ã‹ã®ã‚·ã‚¹ãƒ†ãƒ ã«çµè¨—æ”»æ’ƒã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã„ãŸã®ã§ï¼Œãã£ã¡æ–¹é¢ã§ã‚‚ã£ã¨ç·´ã‚Œã¦ã„ãŸã‚‰ãªã¨ã„ã†æ°—æŒã¡ã§ã™ï¼ï¼ˆä½œå•åŠ›ã…â€¦â€¦ï¼‰</p>
<h2 id="crypto-178pts-elliptic-ring-rsa-27-solves">[crypto 178pts] Elliptic Ring RSA (27 solves)</h2>
<h3 id="overview-1">Overview</h3>
<blockquote>
<p>RSA is hard over integer ring.<br>
What about RSA over elliptic curve ring (!?)</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># q.sage</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="o">...</span> <span class="n">omit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nbits</span> <span class="o">=</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">random_prime_bits</span><span class="p">(</span><span class="n">nbits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Fp</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">Fp</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">Fp</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fp</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ER</span> <span class="o">=</span> <span class="n">EllipticRing</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">P</span> <span class="o">=</span> <span class="n">ER</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">13</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="o">=</span> <span class="n">ER</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;p: </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;C: </span><span class="si">{</span><span class="n">C</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;a: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;b: </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;e: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ãˆã‚‰ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã®ä¸­ã§é‡è¦ãªéƒ¨åˆ†ã¯ä¸Šã®éƒ¨åˆ†ã§ã™ï¼<br>
ã¾ãŸã“ã®æš—å·åŒ–å‡¦ç†ã®ä¸Šã«ã¯ $\Fp$ ã‚’ä¿‚æ•°ã¨ã—ã¦åŸºåº•ã‚’ $E(\Fp)$ ã§å¼µã£ãŸç¾¤ç’°ã®å®Ÿè£…ãŒãªã•ã‚Œã¦ã„ã¾ã™ï¼ï¼ˆæ­£ç¢ºã«å®Ÿè£…ã™ã‚‹ãŸã‚ã«ãã“ãã“é•·ã„ã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸï¼‰<br>
ã“ã®å•é¡Œã¯ï¼Œãã®ç¾¤ç’° $\mathrm{ER}$ ä¸Šã§è¡Œã‚ã‚Œã¦ã„ã‚‹ $e = 13$ ã® RSA ã‚’ç ´ã‚‹ã“ã¨ãŒã‚´ãƒ¼ãƒ«ã¨ãªã‚Šã¾ã™ï¼</p>
<h3 id="solution-1">Solution</h3>
<p>ç¾¤ç’°ãªã®ã§ï¼Œä½•ã‚‰ã‹ã®å¤šé …å¼ç’°ã®å‰°ä½™ç’°ã¨æº–åŒå‹ã§çµã¹ãã†ãªæ°—ãŒã—ã¦ãã¾ã™ï¼ã¨ã„ã†ã“ã¨ã§ã¾ãšã¯ $E(\Fp)$ ã®æ§‹é€ ã¨ãã®ä½æ•° $o := #E(\Fp)$ ã‚’è¨ˆç®—ã—ãŸã„æ°—æŒã¡ã«ãªã£ã¦ãã¾ã™ï¼<br>
å®Ÿéš›ã«è¨ˆç®—ã™ã‚‹ã¨ $o = 192$ ã§ã‚ã‚‹ã“ã¨ã¨ï¼Œ$G := (189, 152)$ ã«ã‚ˆã£ã¦ $E(\Fp) = \left&lt; G \right&gt;$ ã¨ãªã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼<br>
ã—ãŸãŒã£ã¦ $\mathrm{ER} = \Fp[G]$ ã¨ãªã‚Šï¼Œ$[i]G \mapsto x^i$ ã¨ã™ã‚Œã°åŒå‹ $\Fp[G] \simeq \Fp[x]/(x^o - 1)$ ãŒä½œã‚Œã¾ã™ï¼<br>
ã‚ˆã£ã¦ $\mathrm{ER}$ ä¸Šã§ã® RSA ã¯å¤šé …å¼ã®å‰°ä½™ç’°ã§ã® RSA ãŒè§£ã‘ã‚Œã°ç ´ã‚Œã¾ã™ï¼</p>
<p>$o$ ã®å€¤ãŒå°ã•ã„ï¼ˆã¨ã„ã†ã‹ $\Fp[x]$ ã®å› æ•°åˆ†è§£ãŒãã‚‚ãã‚‚ç°¡å˜ï¼‰ãªã®ã§ã“ã® RSA ã¯ç°¡å˜ã«è§£ã‘ã¾ã™ï¼<br>
$e^{-1}$ ã®è¨ˆç®—ã¯ï¼Œ$x^o - 1$ ã®å„å› æ•° $f _ i$ ã«ã¤ã„ã¦ $e^{-1} \bmod (p^{\deg {f _ i}} - 1)$ ã‚’è¨ˆç®—ã—ï¼Œæœ€å¾Œã« CRT ã§ã¾ã¨ã‚ã‚Œã°ã‚ªãƒƒã‚±ãƒ¼ã§ã™ï¼</p>
<p>ã‚½ãƒ«ãƒã©ãº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">EllipticRingElement</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">point</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">other</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="bp">self</span>
</span></span><span class="line"><span class="cl">		<span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">					<span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">					<span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">EllipticRingElement</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">()</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="n">res</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">				<span class="n">E</span> <span class="o">=</span> <span class="n">k1</span> <span class="o">+</span> <span class="n">k2</span>
</span></span><span class="line"><span class="cl">				<span class="n">k</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">					<span class="n">res</span><span class="p">[</span><span class="n">E</span><span class="p">]</span> <span class="o">+=</span> <span class="n">k</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">E</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">						<span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">					<span class="n">res</span><span class="p">[</span><span class="n">E</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">E</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">						<span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">EllipticRingElement</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">st</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">			<span class="n">st</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">*(</span><span class="si">{</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) + &#34;</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">st</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">EllipticRing</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">E</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">	<span class="n">Base</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span>
</span></span><span class="line"><span class="cl">		<span class="bp">self</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">pt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">pt</span><span class="p">[</span><span class="n">P</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Base</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="n">P</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">EllipticRingElement</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">EllipticRingElement</span><span class="p">(</span><span class="nb">dict</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="nf">one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">EllipticRingElement</span><span class="p">({</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Base</span><span class="p">(</span><span class="mi">1</span><span class="p">)})</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="nf">pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">				<span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">			<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">			<span class="n">n</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">left</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">pad1</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">left</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">pad2</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">length</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">-</span><span class="n">left</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">m</span> <span class="o">=</span> <span class="n">pad1</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="n">pad2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">Ps</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">PP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="n">PP</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Ps</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Ps</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Ps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">M</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">coef</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Ps</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="n">M</span><span class="p">[</span><span class="n">pt</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Base</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">EllipticRingElement</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##################################################################### solve part</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;output.txt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">p</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[</span><span class="mi">3</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">	<span class="n">Fp</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">C</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span> <span class="o">=</span> <span class="n">Fp</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[</span><span class="mi">3</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span> <span class="o">=</span> <span class="n">Fp</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[</span><span class="mi">3</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">	<span class="n">e</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[</span><span class="mi">3</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fp</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">ER</span> <span class="o">=</span> <span class="n">EllipticRing</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">terms</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; + &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">	<span class="n">term</span> <span class="o">=</span> <span class="n">terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;*&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">coef</span> <span class="o">=</span> <span class="n">Fp</span><span class="p">(</span><span class="n">term</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">pt</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">term</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">x</span> <span class="o">=</span> <span class="n">Fp</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">y</span> <span class="o">=</span> <span class="n">Fp</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">pt</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">pt</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">C</span><span class="p">[</span><span class="n">pt</span><span class="p">]</span> <span class="o">=</span> <span class="n">coef</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="o">=</span> <span class="n">ER</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">o</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gens:&#34;</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;g: &#34;</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;o: &#34;</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rationals</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">g</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">o</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">rationals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rationals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Px</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Fp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">point_to_polynomial</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">rationals</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span> <span class="o">=</span> <span class="n">Px</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">point</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">		<span class="n">f</span> <span class="o">+=</span> <span class="n">point</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">rationals</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">f</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">polynomial_to_point</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rationals</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">d</span><span class="p">[</span><span class="n">rationals</span><span class="p">[</span><span class="n">cnt</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">		<span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">ER</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">point_to_polynomial</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">rationals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fi</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="n">o</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">factors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">fi</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">factors</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">	<span class="n">factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">factors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ms</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">fmods</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">fmod</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">n</span> <span class="o">=</span> <span class="n">fmod</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">=</span> <span class="n">p</span><span class="o">^</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="o">=</span> <span class="n">inverse_mod</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">fmod</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">ms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">fmods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmod</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">M</span> <span class="o">=</span> <span class="n">crt</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">fmods</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">M</span> <span class="o">=</span> <span class="n">polynomial_to_point</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">rationals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;M:&#34;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## decode</span>
</span></span><span class="line"><span class="cl"><span class="n">points</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span>
</span></span><span class="line"><span class="cl"><span class="n">spoints</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">coef</span> <span class="ow">in</span> <span class="n">spoints</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">coef</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="crypto-226pts-moduhash-16-solves">[crypto 226pts] moduhash (16 solves)</h2>
<h3 id="overview-2">Overview</h3>
<blockquote>
<p>This is related to a base of the theory of elliptic curves!</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">CC</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">n</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">h1</span> <span class="o">=</span> <span class="n">to_hash</span><span class="p">(</span><span class="n">gen_random_hash</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">zi</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;zi	: </span><span class="si">{</span><span class="n">zi</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;h1(zi): </span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="n">zi</span><span class="p">,</span> <span class="n">h1</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">h2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;your hash&gt; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="ow">not</span> <span class="n">hash_eq</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">CC</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;your hash is incorrect&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">quit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ãˆã‚‰ã‚ŒãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä¸­ã§é‡è¦ãªã®ã¯ä¸Šã®éƒ¨åˆ†ã§ã™ï¼</p>
<p>$S \colon \mathbb{C} \ni z \mapsto -1/z \in \mathbb{C}$ï¼Œ$T \colon \mathbb{C} \ni z \mapsto z + 1 \in \mathbb{C}$ ã¨ã—ã¾ã™ï¼<br>
ã¾ãŸç§˜åŒ¿ã•ã‚ŒãŸãƒãƒƒã‚·ãƒ¥é–¢æ•° $h$ ãŒã‚ã‚Šï¼Œã“ã‚Œã¯ $S$ ã¨ $T$ ã®ãƒ©ãƒ³ãƒ€ãƒ ãªé–¢æ•°åˆæˆã«ã‚ˆã£ã¦æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼<br>
å•é¡Œã¨ã—ã¦ã¯ï¼Œã‚ã‚‹ $z \in \mathbb{C}$ ã¨ãã®ãƒãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹å‡ºåŠ› $h(z)$ ãŒä¸ãˆã‚‰ã‚Œã‚‹ã®ã§ $h$ ã‚’å¾©å…ƒã—ã¦ãã ã•ã„ã¨ã„ã†å•é¡Œã§ã™ï¼</p>
<h3 id="solution-2">Solution</h3>
<p>ã¾ãšã¯ $\mathbb{C}$ å…¨ä½“ã§ã¯ãªãï¼Œä¸ŠåŠå¹³é¢ $H$ ã«ã¤ã„ã¦è€ƒãˆã¦ã„ãã¾ã—ã‚‡ã†ï¼<br>
ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ç¾¤ $\Gamma := \mathrm{SL}(\mathbb{Z})/\left\lbrace \pm 1 \right\rbrace$ ã¯ $H$ ã«ä½œç”¨ã—ã¾ã™ï¼<br>
ã“ã®ä½œç”¨ã«ã‚ˆã‚‹è»Œé“ã§ $H$ ã‚’é¡åˆ¥ã§ãã‚‹ãŸã‚ãã®è»Œé“ç©ºé–“ $\Gamma \backslash H$ ã‚’è€ƒãˆã‚‹ã“ã¨ãŒã§ãï¼Œãã“ã‹ã‚‰ã†ã¾ãä»£è¡¨å…ƒã‚’å–ã£ã¦ãã‚Œã°æ¬¡ã§å®šç¾©ã•ã‚Œã‚‹åŸºæœ¬é ˜åŸŸ $F$ ã¨åŒä¸€è¦–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼
$$
F := \left\lbrace \tau \in H \mid |\tau| \geq 1,\ -1/2 &lt; \mathrm{Re}(\tau) \leq 1/2 \right\rbrace
$$
ã¤ã¾ã‚Šæ¬¡ã®å‘½é¡ŒãŒæˆã‚Šç«‹ã¡ã¾ã™ï¼
$$
\forall \tau \in H.\ \exists \gamma \in \Gamma\ s.t.\ \gamma (\tau) \in F.
$$</p>
<p>ã¾ãŸå¾Œè¿°ã™ã‚‹ $\Gamma$ ã®ç”Ÿæˆå…ƒã‹ã‚‰ $h \in \Gamma$ ãªã®ã§ï¼Œ$\tau$ ã¨ $h(\tau)$ ã®è»Œé“ã«ã¤ã„ã¦ $\Gamma \tau = \Gamma h(\tau)$ ãŒæˆã‚Šç«‹ã¡ã¾ã™ï¼<br>
ã—ãŸãŒã£ã¦ $\tau, h(\tau) \in H$ ãŒä¸ãˆã‚‰ã‚ŒãŸã¨ãï¼Œ$\gamma_{\tau}(\tau), \gamma_{h(\tau)}(h(\tau)) \in F$ ã¨ãªã‚‹ $\gamma_{\tau}, \gamma_{h(\tau)} \in \Gamma$ ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚Œã° $\gamma_{\tau}(\tau) = \gamma_{h(\tau)}(h(\tau))$ ã¨ãªã‚Šã¾ã™ï¼<br>
ã“ã“ã¾ã§ãã‚Œã°ã‚ã¨ã¯ç°¡å˜ã§ï¼Œ$\gamma_{h(\tau)}^{-1} \circ \gamma_{\tau} = h$ ã¨ãªã‚‹ãŸã‚ç›®çš„ã®ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</p>
<p><img src="/blog/post15/diagram.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ã‚ã¨ã¯ $H$ ã®å…ƒã‚’ $F$ ã«ç§»ã™ $\gamma$ ã§ã™ãŒï¼Œã“ã‚Œã¯ $\Gamma$ ã®ã‚ã‚‹æ€§è³ªã‹ã‚‰æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼
$S,T$ ã‚’ $H$ ã¸ã®ä½œç”¨ã¨è¦‹ã‚‹ã¨
$$
\begin{array}{l}
S=\begin{pmatrix}
0 &amp; -1\\
1 &amp; 0
\end{pmatrix},\
T=\begin{pmatrix}
1 &amp; 1\\
0 &amp; 1
\end{pmatrix}
\end{array}
$$
ã¨è¡¨ç¾ã§ãã¾ã™ï¼å®Ÿã¯ $\Gamma$ ã¯ $S,T$ ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ï¼Œã¤ã¾ã‚Š $\Gamma = \left&lt; S, T \right&gt;$ ã¨æ›¸ã‘ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ï¼ï¼ˆã‚ˆã£ã¦ $h \in \Gamma$ï¼‰</p>
<p>ã“ã®äº‹å®Ÿã«ã‚ˆã‚Šï¼Œ$\tau \in H$ ãŒä¸ãˆã‚‰ã‚ŒãŸã¨ãæ¬¡ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ $F$ ã«å†™ã™ã“ã¨ãŒã§ãã¾ã™ï¼</p>
<ol>
<li>$\mathrm{Re}(\tau) &gt; 0.5$ ãªã‚‰ $\tau$ ã« $T^{-1}$ ã‚’ä½œç”¨ï¼Œ$\mathrm{Re}(\tau) &lt; -0.5$ ãªã‚‰ $\tau$ ã« $T$ ã‚’ä½œç”¨ã•ã›ã‚‹</li>
<li>$|\mathrm{Re}(\tau)| \leq 0.5$ ã«ãªã‚‹ã¾ã§ step 1 ã‚’ç¹°ã‚Šè¿”ã™ï¼ˆå®Ÿéƒ¨ã‚’ $F$ ã«åˆã‚ã›ã‚‹ï¼‰</li>
<li>$|\tau| &lt; 1$ ã®ã¨ã $\tau$ ã« $S$ ã‚’ä½œç”¨ã•ã›ã‚‹ï¼ˆãƒãƒ«ãƒ ã‚’åˆã‚ã›ã‚‹ï¼‰</li>
<li>$\tau \in F$ ã§ãªã‘ã‚Œã° step 1 ã«æˆ»ã‚‹</li>
</ol>
<p>ã¨ã„ã†ã“ã¨ã§ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ã‚Œã°ï¼Œä¸ŠåŠå¹³é¢ã«ã¤ã„ã¦å•é¡Œã‚’è§£ãã“ã¨ãŒã§ãã¾ã™ï¼ï¼ˆãŸã ã— $T^{-1} = STSTS$ ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼‰<br>
ã¾ãŸä¸‹åŠå¹³é¢ã«ã¤ã„ã¦ã¯ä»Šã¾ã§ã® $H$ ã®è­°è«–ã‚’ $-H$ ã«å–ã‚Šæ›¿ãˆã‚‹ã ã‘ãªã®ã§åŒã˜æ–¹æ³•ã§è§£ãã“ã¨ãŒã§ãã¾ã™ï¼</p>
<p>ã‚½ãƒ«ãƒã©ãº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">T</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">U</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">z</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gen_random_hash</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">r</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">getrandbits</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">r</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">to_hash</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">sts</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&#34;0&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">res</span> <span class="o">+=</span> <span class="s2">&#34;S&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">res</span> <span class="o">+=</span> <span class="s2">&#34;T&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hash_inv</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&#34;S&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;S&#34;</span> <span class="o">+</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;U&#34;</span> <span class="o">+</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;U&#34;</span><span class="p">,</span> <span class="s2">&#34;STSTS&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;SS&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;TSTSTS&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hash</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&#34;S&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">res</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&#34;T&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">res</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&#34;U&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">res</span> <span class="o">=</span> <span class="n">U</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hash_eq</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">CC</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">zr</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="n">h1zr</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">zr</span><span class="p">,</span> <span class="n">h1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">h2zr</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">zr</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;abs: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">h1zr</span> <span class="o">-</span> <span class="n">h2zr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">h1zr</span> <span class="o">-</span> <span class="n">h2zr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-15</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">in_fundamental</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="ow">and</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gen_to_fundamental_hash</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">res</span> <span class="o">+=</span> <span class="s2">&#34;U&#34;</span>
</span></span><span class="line"><span class="cl">				<span class="n">z</span> <span class="o">=</span> <span class="n">U</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">elif</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">res</span> <span class="o">+=</span> <span class="s2">&#34;T&#34;</span>
</span></span><span class="line"><span class="cl">				<span class="n">z</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="k">break</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">res</span> <span class="o">+=</span> <span class="s2">&#34;S&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="n">z</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">in_fundamental</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="k">break</span>
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;U&#34;</span><span class="p">,</span> <span class="s2">&#34;STSTS&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;SS&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;TSTSTS&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s2">&#34;sage&#34;</span><span class="p">,</span> <span class="s2">&#34;./server.sage&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">CC</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">zi</span> <span class="o">=</span> <span class="n">CC</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;: &#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">	<span class="n">h1zi</span> <span class="o">=</span> <span class="n">CC</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;: &#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">	<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;your hash&gt; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;zi:&#34;</span><span class="p">,</span> <span class="n">zi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;h1zi:&#34;</span><span class="p">,</span> <span class="n">h1zi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">hz</span> <span class="o">=</span> <span class="n">gen_to_fundamental_hash</span><span class="p">(</span><span class="n">zi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">hh1zi</span> <span class="o">=</span> <span class="n">gen_to_fundamental_hash</span><span class="p">(</span><span class="n">h1zi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">hh1zi_inv</span> <span class="o">=</span> <span class="n">hash_inv</span><span class="p">(</span><span class="n">hh1zi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1"># print(&#34;hz:&#34;, hz)</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># print(&#34;hh1zi_inv:&#34;, hh1zi_inv)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="n">hz</span> <span class="o">+</span> <span class="n">hh1zi_inv</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®Ÿã¯å…ƒã€… moduhash ãŒ warmup ã«ãªã‚‹äºˆå®šã§ã—ãŸï¼<br>
å¤©æ‰ ptr-yudai æ°ãŒ SquareRNG ã‚’ä½œã£ã¦ãã‚Œã¦ã„ãªã‹ã£ãŸã‚‰ï¼Œä»Šé ƒåƒ•ã¯è²¬ä»»ã‚’å–ã£ã¦åˆ‡è…¹ã™ã‚‹ã“ã¨ã«ãªã£ã¦ã„ãŸã§ã—ã‚‡ã†ï¼</p>
<h2 id="crypto-340pts-unlimited-braid-works-6-solves">[crypto 340pts] Unlimited Braid Works (6 solves)</h2>
<h3 id="overview-3">Overview</h3>
<blockquote>
<p>This is probably hard problem.
Is this commutative or non-commutative?</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="o">...</span><span class="n">omit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Input the security parameter&gt; &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The security parameter is too small !!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The security parameter must be even !!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;n: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## ------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Key Generation</span>
</span></span><span class="line"><span class="cl"><span class="c1">## ------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Bn</span> <span class="o">=</span> <span class="n">BraidGroup</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gs</span> <span class="o">=</span> <span class="n">Bn</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">K</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl"><span class="n">u</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># u must be twisted</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="ow">not</span> <span class="n">gs</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">u</span><span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">u</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;u: </span><span class="si">{</span><span class="n">prod</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">right_normal_form</span><span class="p">())</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">al</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">gs</span><span class="p">[:</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">v</span> <span class="o">=</span> <span class="n">al</span> <span class="o">*</span> <span class="n">u</span> <span class="o">*</span> <span class="n">al</span><span class="o">^-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;v: </span><span class="si">{</span><span class="n">prod</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">right_normal_form</span><span class="p">())</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## ------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Encryption</span>
</span></span><span class="line"><span class="cl"><span class="c1">## ------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pad_length</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">left_length</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pad_length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pad1</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">left_length</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pad2</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">pad_length</span><span class="o">-</span><span class="n">left_length</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">pad1</span> <span class="o">+</span> <span class="n">flag</span> <span class="o">+</span> <span class="n">pad2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">br</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:],</span> <span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="n">br</span> <span class="o">*</span> <span class="n">u</span> <span class="o">*</span> <span class="n">br</span><span class="o">^-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">br</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">br</span><span class="o">^-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">right_normal_form</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^^</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;w: </span><span class="si">{</span><span class="n">prod</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_normal_form</span><span class="p">())</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;d: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒä¸ãˆã‚‰ã‚Œã¾ã™ï¼<br>
ã“ã‚Œã¯ Braidç¾¤ã‚’åˆ©ç”¨ã—ãŸéå¯æ›ãªæš—å·ã‚·ã‚¹ãƒ†ãƒ ã§ï¼ŒBraidç¾¤ã® Conjugacy Problem ã‚’åŸºã«ã—ã¦ã„ã¾ã™ï¼ï¼ˆå•é¡Œæ–‡ã® probably hard ã¯ conjugacy problem ã‚’æŒ‡ã—ã¦ã„ã‚‹ï¼‰</p>
<p>$B _ n$ ã‚’$n$ æœ¬ã®çµ„ã¿ç´ã«ã‚ˆã‚‹ Braidç¾¤ã¨ã—ï¼Œãã®ã†ã¡å·¦å´ $l$ æœ¬ã®çµ„ã¿ç´ã®é›†åˆã‚’ $\LB$ï¼Œå³å´ $r$ æœ¬ã®çµ„ã¿ç´ã®é›†åˆã‚’ $\RB$ ã¨ã—ã¾ã™ï¼<br>
ã¾ãŸ $a _ l \in \LB$ ã‚’ç§˜å¯†éµã¨ã—ã¦ï¼Œå…¬é–‹éµã‚’ $v := a _ l u a _ l^{-1}$ ã¨ã—ã¾ã™ï¼</p>
<p>$m$ ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ï¼Œã•ã‚‰ã« $H \colon B _ n \to \left\lbrace 0, 1 \right\rbrace^{k}$ ã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºç”¨ã®é–¢æ•°ã¨ã—ã¾ã™ï¼<br>
ã“ã®ã¨ãæš—å·åŒ–ã®å‡¦ç†ã¯ï¼Œãƒ©ãƒ³ãƒ€ãƒ ãªçµ„ã¿ç´ $b _ r \in \RB$ ã‚’é¸ã³ $w := b _ r u b _ r^{-1}$ï¼Œ$d := H(b _ r v b _ r ^{-1}) \oplus$ ã‚’è¨ˆç®—ã—ï¼Œæœ€å¾Œã«æš—å·æ–‡ã‚’ $(w, d)$ ã¨ã™ã‚‹ã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ï¼</p>
<h3 id="solution-3">Solution</h3>
<p>ã‚‚ã—ç§˜å¯†éµ $a _ l$ ãŒã‚ã‹ã£ã¦ã„ã‚Œã°ï¼Œæ¬¡ã®ã‚ˆã†ã«è¤‡åˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼
$$
\begin{aligned}
H(a_l w a_l^{-1}) \oplus d &amp;= H(a_l b_r u b_r^{-1} a_l^{-1})\\
&amp;= H(b_r v b_r^{-1}) \oplus H(b_r v b_r^{-1}) \oplus m\\
&amp;= m
\end{aligned}
$$</p>
<p>ã—ã‹ã—å½“ç„¶ $a _ l$ ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ï¼</p>
<p>ã“ã®æš—å·ã‚·ã‚¹ãƒ†ãƒ ã¯æ­£ã—ãå‹•ã„ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã™ãŒï¼Œå®Ÿã¯ $u$ ã®ç”Ÿæˆéƒ¨åˆ†ã«è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™ï¼<br>
ã¨ã„ã†ã®ã‚‚ï¼Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $n$ ãŒååˆ†ã«å¤§ãã„ã¨ã $u$ ã‚’æ§‹æˆã™ã‚‹ãŸã‚ã® Artin generator ãŒã‚¹ãƒ‘ãƒ¼ã‚¹ã«é¸ã°ã‚Œã¾ã™ï¼ï¼ˆãŸã ã— $n$ ãŒå¤§ãã™ãã‚‹ã¨ã‚µãƒ¼ãƒå´ã§ã®æš—å·åŒ–å‡¦ç†ã«æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã¦ã—ã¾ã†ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼å•é¡Œã®è§£æ³•ã«ã¯å…¨ãå½±éŸ¿ãŒãªã„ãŸã‚ï¼Œã‚³ãƒ³ãƒ†ã‚¹ãƒˆä¸­ã« <code>alarm(30)</code> ã‚’è¿½åŠ ã—ã¦ä¿®æ­£ã—ã¾ã—ãŸï¼‰<br>
ãã®ãŸã‚ $z$ ã‚’ $\LB$ ã¨ $\RB$ ã‚’è·¨ãã‚ˆã†ãª Artin Generator ã¨ã™ã‚‹ã¨ï¼Œ$x_1 \in \LB$ï¼Œ$x_2 \in RB$ ã§æ¬¡ã‚’æº€ãŸã™ã‚ˆã†ãªã‚‚ã®ãŒå­˜åœ¨ã™ã‚‹ç¢ºç‡ãŒéå¸¸ã«é«˜ããªã‚Šã¾ã™ï¼
$$
\begin{cases}
u = x_1 x_2 z\\
z \text{ is commutive with } a_l,b_r,x_1,x_2
\end{cases}
$$
ã—ãŸãŒã£ã¦
$$
\begin{aligned}
v &amp;= a_l u a_l^{-1}\\
&amp;= a_l (x_1 x_2 z) a_l^{-1}\\
&amp;= (a_l x_1 a_l^{-1}) x_2 z
\end{aligned}
$$ã¨
$$
\begin{aligned}
w &amp;= b_r u b_r^{-1}\\
&amp;= b_r (x_1 x_2 z) b_r^{-1}\\
&amp;= x_1 (b_r x_2 b_r^{-1}) z
\end{aligned}
$$
ã«ã‚ˆã‚Šæ¬¡ã®å¼ãŒå¾—ã‚‰ã‚Œã¾ã™ï¼
$$
\begin{aligned}
a_l x_1 a_l^{-1} &amp;= v z^{-1} x_2^{-1}\\
b_r x_2 b_r^{-1} &amp;= x_1^{-1} w z^{-1}
\end{aligned}
$$</p>
<p>ã‚ˆã£ã¦ $a_lwa_l^{-1} = (vz^{-1}x_2^{-1})(x_1^{-1}wz^{-1})z$ ã¨ã™ã‚‹ã“ã¨ã§è¤‡åˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</p>
<p><img src="/blog/post15/neco.jpg"
	
	
	
	loading="lazy"
	
	
></p>
<p>ã‚½ãƒ«ãƒã©ãº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">30000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hash</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s2">&#34;sage&#34;</span><span class="p">,</span> <span class="s2">&#34;./server.sage&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;50&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;n: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Bn</span> <span class="o">=</span> <span class="n">BraidGroup</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gs</span> <span class="o">=</span> <span class="n">Bn</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">braid_eval</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">res</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;*&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">res</span> <span class="o">*=</span> <span class="n">sage_eval</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;gs&#34;</span><span class="p">:</span> <span class="n">gs</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">u</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;: &#34;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">u</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&#34;s([0-9]+)&#34;</span><span class="p">,</span> <span class="s2">&#34;gs[</span><span class="se">\\</span><span class="s2">1]&#34;</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">u</span> <span class="o">=</span> <span class="n">sage_eval</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;gs&#34;</span><span class="p">:</span> <span class="n">gs</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;u: </span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">v</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;: &#34;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">v</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\\\\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">v</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&#34;s([0-9]+)&#34;</span><span class="p">,</span> <span class="s2">&#34;gs[</span><span class="se">\\</span><span class="s2">1]&#34;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">v</span> <span class="o">=</span> <span class="n">sage_eval</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;gs&#34;</span><span class="p">:</span> <span class="n">gs</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;v: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;: &#34;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\\\\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&#34;s([0-9]+)&#34;</span><span class="p">,</span> <span class="s2">&#34;gs[</span><span class="se">\\</span><span class="s2">1]&#34;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="n">sage_eval</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;gs&#34;</span><span class="p">:</span> <span class="n">gs</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="c1"># log.info(f&#34;w: {w}&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;d: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">factors</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">Tietze</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">	<span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;factors: </span><span class="si">{</span><span class="n">factors</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">x2</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">x1</span> <span class="o">*=</span> <span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">x2</span> <span class="o">*=</span> <span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="n">cnt</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">z</span> <span class="o">==</span> <span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r1</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">z</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x2</span><span class="o">^-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">r2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">w</span> <span class="o">*</span> <span class="n">z</span><span class="o">^-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">right_normal_form</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dd</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">xx</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">	<span class="n">xx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^^</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;flag: </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/blog/tags/elliptic-curve/">elliptic curve</a>
        
            <a href="/blog/tags/math/">math</a>
        
            <a href="/blog/tags/writeup/">writeup</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">é–¢é€£ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/blog/p/%E8%B6%85%E6%A5%95%E5%86%86%E6%9B%B2%E7%B7%9A%E6%9A%97%E5%8F%B7%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B%E3%81%9E/">
        
        

        <div class="article-details">
            <h2 class="article-title">è¶…æ¥•å††æ›²ç·šæš—å·ã‚’ç†è§£ã™ã‚‹ã</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/blog/p/zer0pts-ctf-2021-writeup-%E6%97%A5%E6%9C%AC%E8%AA%9E/">
        
        

        <div class="article-details">
            <h2 class="article-title">zer0pts ctf 2021 writeup (æ—¥æœ¬èª)</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-mitsu1119-github-io-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 ã¿ã¤ã¿ã¤ã¿ã¤ã§ã™ã‹ï¼Ÿ
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ãƒ†ãƒ¼ãƒ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> ã¯ <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ã«ã‚ˆã£ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/blog/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
